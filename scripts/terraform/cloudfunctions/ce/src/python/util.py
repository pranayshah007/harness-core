# Copyright 2021 Harness Inc. All rights reserved.
# Use of this source code is governed by the PolyForm Free Trial 1.0.0 license
# that can be found in the licenses directory at the root of this repository, also available at
# https://polyformproject.org/wp-content/uploads/2020/05/PolyForm-Free-Trial-1.0.0.txt.

import json
import bq_schema
import time
import re
import datetime
import hashlib
import requests
import os

from google.cloud import bigquery
from google.cloud import functions_v2
from google.cloud import pubsub_v1
from google.cloud.exceptions import NotFound

PROJECTID = os.environ.get('GCP_PROJECT', 'ccm-play')
publisher = pubsub_v1.PublisherClient()
ACCOUNTID_LOG = ""
CF_EXECUTION_ID = ""
TABLE_NAME_FORMAT = "%s.BillingReport_%s.%s"

# TABLE NAMES
CLUSTERDATAAGGREGATED = "clusterDataAggregated"
CLUSTERDATA = "clusterData"
CLUSTERDATAHOURLY = "clusterDataHourly"
CLUSTERDATAHOURLYAGGREGATED = "clusterDataHourlyAggregated"
PREAGGREGATED = "preAggregated"
AWSEC2INVENTORYMETRIC = "awsEc2InventoryMetric"
AWSEC2INVENTORY = "awsEc2Inventory"
AWSEBSINVENTORYMETRICS = "awsEbsInventoryMetrics"
AWSEBSINVENTORY = "awsEbsInventory"
AWSRDSINVENTORY = "awsRdsInventory"
UNIFIED = "unifiedTable"
CURRENCYCONVERSIONFACTORUSERINPUT = "currencyConversionFactorUserInput"
LABELKEYSTOCOLUMNMAPPING = "labelKeysToColumnMapping"
MSPMARKUP = 'mspMarkup'
AWSCURPREFIX = "awscur"
COSTAGGREGATED = "costAggregated"
CEINTERNALDATASET = "CE_INTERNAL"
GCPCOSTPREFIX = "gcp_cost_export"
GCPINSTANCEINVENTORY = "gcpInstanceInventory"
GCPDISKINVENTORY = "gcpDiskInventory"
AZUREVMINVENTORY = "azureVMInventory"
AZUREVMINVENTORYMETRIC = "azureVMInventoryMetric"
AZURECOSTPREFIX = "azurecost"
CONNECTORDATASYNCSTATUSTABLE = "connectorDataSyncStatus"
GCPCONNECTORINFOTABLE = "gcpConnectorInfo"
CURRENCY_LIST = ["AED", "ARS", "AUD", "BRL", "CAD", "CNY", "EUR", "GBP",
                 "INR", "JPY", "MXN", "NOK", "NZD", "RUB", "SGD", "USD"]
LABELS_FLATTENING_ENABLED_ACCOUNTS = ["EfOfrUbHTtupeZjUqxlHBg", "JQ3KKI5yRTGe37OrCiZaTA",
                                      "k9C6xngtS06yOSMV7hPGlQ", "l4zWxf3BTs6mEyIMmQjQIg",
                                      "wFHXHD0RRQWoO8tIZT5YVw", "Z60xsRGoTeqOoAFRCsmlBQ",
                                      "aYXZz76ETU-_3LLQSzBt1Q", "W3jccPA5Q-qtHNTl1uYBhw",
                                      "pC_7h33wQTeZ_j-libvF4A", "H6rHO8vtQYKelD_wgjnMpA"]
ACCOUNTS_ENABLED_WITH_ADDITIONAL_AWS_FIELDS_IN_UNIFIED_TABLE = ["pC_7h33wQTeZ_j-libvF4A",
                                                                "zbT61-E8QviU5SHLH9rKzA",
                                                                "Z60xsRGoTeqOoAFRCsmlBQ"]
BACKUP_CURRENCY_FX_RATES = {
    "2022-01-01":{"date":"2022-01-01","usd":{"ada":0.756319,"aed":3.673043,"afn":103.750443,"all":106.650443,"amd":480.234504,"ang":1.802592,"aoa":550.590608,"ars":102.690012,"aud":1.375801,"awg":1.800001,"azn":1.703971,"bam":1.728132,"bbd":2.01951,"bch":0.002308,"bdt":85.737467,"bgn":1.718311,"bhd":0.376957,"bif":2003.500747,"bmd":1,"bnb":0.001945,"bnd":1.350134,"bob":6.896581,"brl":5.571306,"bsd":1.000213,"btc":2.2e-05,"btn":74.371452,"bwp":11.760184,"byn":2.557522,"byr":19600.007305,"bzd":2.016153,"cad":1.263915,"cdf":2002.504667,"chf":0.911704,"clf":0.030877,"clp":852.000679,"cny":6.355906,"cop":4065.331515,"crc":642.088668,"cuc":1,"cup":26.50001,"cve":97.250431,"czk":21.872258,"djf":177.72046,"dkk":6.539093,"doge":5.840507,"dop":57.375062,"dzd":138.805681,"egp":15.709769,"ern":15.000084,"etb":49.15041,"etc":0.029168,"eth":0.00027,"eur":0.879395,"fjd":2.124505,"fkp":0.75438,"gbp":0.739649,"gel":3.095042,"ggp":0.75438,"ghs":6.150392,"gip":0.75438,"gmd":52.750409,"gnf":9325.003832,"gtq":7.719042,"gyd":209.16103,"hkd":7.796107,"hnl":24.40385,"hrk":6.610391,"htg":100.291619,"huf":324.710509,"idr":14242.005308,"ils":3.112646,"imp":0.75438,"inr":74.514078,"iqd":1460.000544,"irr":42275.01611,"isk":129.790435,"jep":0.75438,"jmd":153.996488,"jod":0.709204,"jpy":115.108082,"kes":113.150427,"kgs":84.803833,"khr":4070.001868,"kmf":434.875201,"kpw":900.000258,"krw":1188.880827,"kwd":0.302521,"kyd":0.833481,"kzt":435.092408,"lak":11185.004518,"lbp":1513.000913,"link":0.050882,"lkr":202.921709,"lrd":145.125093,"lsl":15.950387,"ltc":0.006796,"ltl":2.952741,"lvl":0.60489,"lyd":4.603766,"mad":9.280384,"mdl":17.799099,"mga":3965.001825,"mkd":54.454284,"mmk":1778.409382,"mnt":2858.385719,"mop":8.034234,"mro":356.999961,"mur":43.597202,"mvr":15.403747,"mwk":814.000648,"mxn":20.497311,"myr":4.176505,"mzn":63.830402,"nad":15.950383,"ngn":411.95053,"nio":35.403737,"nok":8.817948,"npr":118.993974,"nzd":1.461563,"omr":0.384996,"pab":1.000213,"pen":3.989505,"pgk":3.525039,"php":51.000361,"pkr":178.250441,"pln":4.035305,"pyg":6881.530124,"qar":3.64104,"ron":4.351106,"rsd":103.385263,"rub":74.791632,"rwf":1015.000378,"sar":3.754176,"sbd":8.093926,"scr":13.606865,"sdg":437.503841,"sek":9.050053,"sgd":1.348651,"shp":1.377405,"sll":11255.004533,"sos":584.000556,"srd":20.808046,"std":20697.988723,"svc":8.751858,"syp":2512.49372,"szl":15.950376,"thb":33.195051,"theta":0.210542,"tjs":11.301782,"tmt":3.510001,"tnd":2.875805,"top":2.274604,"trx":13.231364,"try":13.321109,"ttd":6.793757,"twd":27.717114,"tzs":2306.001195,"uah":27.28804,"ugx":3545.717728,"usd":1,"usdt":0.997149,"uyu":44.625896,"uzs":10820.004367,"vef":213830302037.97214,"vnd":22855.008519,"vuv":113.252695,"wst":2.600172,"xaf":579.600654,"xag":0.042953,"xau":0.000547,"xcd":2.702552,"xdr":0.714652,"xlm":3.732903,"xof":579.503818,"xpf":105.850403,"xrp":1.1978,"yer":250.250457,"zar":15.951051,"zmk":9001.206948,"zmw":16.663433,"zwl":321.999712}},
    "2022-02-01":{"date":"2022-02-01","usd":{"ada":0.948606,"aed":3.672981,"afn":101.999816,"all":107.697414,"amd":482.779734,"ang":1.795303,"aoa":529.092078,"ars":105.166512,"aud":1.415389,"awg":1.8,"azn":1.700254,"bam":1.752983,"bbd":2.019422,"bch":0.003502,"bdt":85.990412,"bgn":1.743127,"bhd":0.376933,"bif":1970.000244,"bmd":1,"bnb":0.002657,"bnd":1.355088,"bob":6.896076,"brl":5.304602,"bsd":1.000139,"btc":2.6e-05,"btn":74.712732,"bwp":11.683972,"byn":2.601023,"byr":19600.002431,"bzd":2.016106,"cad":1.271361,"cdf":2012.000514,"chf":0.92715,"clf":0.02902,"clp":800.730146,"cny":6.36098,"cop":3943.020489,"crc":641.562444,"cuc":1,"cup":26.500004,"cve":98.874996,"czk":21.675404,"djf":177.719531,"dkk":6.626699,"doge":7.043444,"dop":57.749919,"dzd":140.322009,"egp":15.727104,"ern":15.000021,"etb":49.799541,"etc":0.038844,"eth":0.000371,"eur":0.89058,"fjd":2.164975,"fkp":0.72792,"gbp":0.74405,"gel":3.044962,"ggp":0.72792,"ghs":6.290081,"gip":0.72792,"gmd":53.000012,"gnf":9002.505176,"gtq":7.689061,"gyd":209.246597,"hkd":7.797311,"hnl":24.579648,"hrk":6.694699,"htg":102.010777,"huf":316.439742,"idr":14356.50178,"ils":3.17935,"imp":0.72792,"inr":74.556059,"iqd":1460.500181,"irr":42250.005186,"isk":127.710201,"jep":0.72792,"jmd":156.356307,"jod":0.708994,"jpy":115.161516,"kes":113.596868,"kgs":84.797413,"khr":4065.501181,"kmf":439.250321,"kpw":900.000269,"krw":1206.890021,"kwd":0.303008,"kyd":0.833494,"kzt":434.788508,"lak":11345.000967,"lbp":1513.999961,"link":0.058396,"lkr":203.033701,"lrd":152.475033,"lsl":15.520242,"ltc":0.00912,"ltl":2.95274,"lvl":0.60489,"lyd":4.615031,"mad":9.436015,"mdl":18.003525,"mga":4000.000545,"mkd":55.238128,"mmk":1778.255335,"mnt":2858.831518,"mop":8.033611,"mro":356.999873,"mur":43.697927,"mvr":15.450185,"mwk":817.504692,"mxn":20.642562,"myr":4.1855,"mzn":63.829654,"nad":15.520104,"ngn":415.830275,"nio":35.459902,"nok":8.907141,"npr":119.535764,"nzd":1.521185,"omr":0.385012,"pab":1.000229,"pen":3.839949,"pgk":3.514947,"php":51.195,"pkr":176.829951,"pln":4.08055,"pyg":7089.856446,"qar":3.641014,"ron":4.404302,"rsd":104.60006,"rub":77.33902,"rwf":1015.000126,"sar":3.752002,"sbd":8.110349,"scr":14.52447,"sdg":441.000164,"sek":9.332022,"sgd":1.351596,"shp":1.377402,"sll":11462.506834,"sos":585.000428,"srd":20.879501,"std":20697.983575,"svc":8.752236,"syp":2512.000087,"szl":15.403191,"thb":33.205024,"theta":0.341649,"tjs":11.297242,"tmt":3.5,"tnd":2.905998,"top":2.267951,"trx":16.872227,"try":13.303203,"ttd":6.788796,"twd":27.775003,"tzs":2311.000121,"uah":28.418641,"ugx":3507.706256,"usd":1,"usdt":0.997428,"uyu":43.953095,"uzs":10812.498093,"vef":213830248859.7712,"vnd":22650.002809,"vuv":113.671428,"wst":2.612343,"xaf":587.885786,"xag":0.044487,"xau":0.000557,"xcd":2.702551,"xdr":0.719132,"xlm":4.985119,"xmr":0.006836,"xof":587.501697,"xpf":106.924986,"xrp":1.621702,"yer":250.250264,"zar":15.382252,"zmk":9001.200116,"zmw":18.10355,"zwl":321.999632}},
    "2022-03-01":{"date":"2022-03-01","usd":{"1inch":0.655659,"ada":1.024506,"aed":3.673099,"afn":91.750524,"algo":1.138858,"all":108.250245,"amd":481.472373,"ang":1.803134,"aoa":496.629592,"ars":107.395209,"atom":0.030977,"aud":1.377365,"avax":0.011302,"awg":1.800251,"azn":1.715111,"bam":1.747214,"bbd":2.019921,"bch":0.002949,"bdt":86.016126,"bgn":1.743395,"bhd":0.377041,"bif":2014.500652,"bmd":1,"bnb":0.002509,"bnd":1.358341,"bob":6.88828,"brl":5.160399,"bsd":1.000402,"btc":2.3e-05,"btn":75.468588,"busd":1.001342,"bwp":11.660514,"byn":3.113901,"byr":19600.006337,"bzd":2.016527,"cad":1.267275,"cdf":2014.502212,"chf":0.917625,"chz":5.107562,"clf":0.028964,"clp":799.208087,"cny":6.309605,"cop":3927.67127,"crc":641.4402,"cro":2.256656,"cuc":1,"cup":26.500008,"cve":98.594558,"czk":22.448963,"dai":1.000146,"djf":177.720182,"dkk":6.633502,"doge":7.493439,"dop":54.449936,"dot":0.052201,"dzd":141.342017,"egld":0.006559,"egp":15.707474,"enj":0.633119,"ern":15.000024,"etb":50.800644,"etc":0.032341,"eth":0.000339,"eur":0.89188,"fil":0.045668,"fjd":2.1241,"fkp":0.72792,"ftt":0.021591,"gbp":0.745086,"gel":3.170399,"ggp":0.72792,"ghs":6.774966,"gip":0.72792,"gmd":53.04995,"gnf":8965.003,"grt":2.636015,"gtq":7.726016,"gyd":209.312366,"hkd":7.813453,"hnl":24.550237,"hrk":6.747398,"htg":104.686089,"huf":330.360237,"icp":0.049739,"idr":14380.004649,"ils":3.205811,"imp":0.72792,"inj":0.177558,"inr":75.285174,"iqd":1460.500472,"irr":42275.013998,"isk":126.469941,"jep":0.72792,"jmd":155.053048,"jod":0.709009,"jpy":115.06254,"kes":113.849859,"kgs":93.291055,"khr":4066.001179,"kmf":438.949805,"kpw":900.000448,"krw":1201.705351,"ksm":0.007556,"kwd":0.30285,"kyd":0.833762,"kzt":489.842931,"lak":11390.003395,"lbp":1513.000622,"link":0.065624,"lkr":202.096673,"lrd":154.250281,"lsl":13.605011,"ltc":0.00873,"ltl":2.952741,"luna":191.668449,"lvl":0.604891,"lyd":4.609998,"mad":9.546506,"matic":0.609604,"mdl":18.408439,"mga":3985.0007,"mkd":54.916326,"mmk":1779.000736,"mnt":2858.832088,"mop":8.052585,"mro":356.999944,"mur":43.501932,"mvr":15.44982,"mwk":808.500779,"mxn":20.490509,"myr":4.193503,"mzn":63.829753,"nad":15.394592,"ngn":416.019785,"nio":35.479742,"nok":8.793203,"npr":120.749919,"nzd":1.478586,"omr":0.385006,"one":631.552752,"pab":1.000402,"pen":3.7975,"pgk":3.507498,"php":51.175024,"pkr":177.449818,"pln":4.189152,"pyg":7041.90475,"qar":3.641014,"ron":4.413303,"rsd":104.935145,"rub":105.008534,"rwf":1012.500328,"sar":3.751572,"sbd":8.080844,"scr":14.400147,"sdg":445.000018,"sek":9.464852,"sgd":1.355626,"shib":38484.730385,"shp":1.377404,"sll":11705.003584,"sol":0.010083,"sos":584.000372,"srd":20.456507,"std":20697.9877,"svc":8.753409,"syp":2512.000588,"szl":15.393578,"thb":32.688509,"theta":0.296225,"tjs":11.295161,"tmt":3.500001,"tnd":2.911499,"top":2.28815,"trx":16.0429,"try":13.830694,"ttd":6.788693,"twd":28.018507,"tzs":2315.000532,"uah":30.063884,"ugx":3549.401095,"uni":11500.106952,"usd":1,"usdc":0.999974,"usdt":0.999472,"uyu":42.305387,"uzs":10890.003103,"vef":213830291473.81973,"vet":18.933589,"vnd":22810.007375,"vuv":113.671451,"wbtc":2.3e-05,"wst":2.612343,"xaf":586.000475,"xag":0.044408,"xau":0.000553,"xcd":2.702551,"xdr":0.71763,"xlm":5.016721,"xmr":0.005779,"xof":586.498424,"xpf":106.675062,"xrp":1.274438,"yer":250.250031,"zar":15.382015,"zmk":9001.234034,"zmw":17.752226,"zwl":321.999696}},
    "2022-04-01":{"date":"2022-04-01","usd":{"1inch":0.561216,"ada":0.87138,"aed":3.673102,"afn":88.49831,"algo":1.056691,"all":109.600689,"amd":485.909629,"ang":1.800578,"aoa":448.086853,"ars":111.005447,"atom":0.034268,"aud":1.33515,"avax":0.010276,"awg":1.800499,"azn":1.703064,"bam":1.761501,"bbd":2.017274,"bch":0.002576,"bdt":86.146193,"bgn":1.765533,"bhd":0.377006,"bif":2009.999575,"bmd":1,"bnb":0.002326,"bnd":1.353045,"bob":6.868711,"brl":4.739499,"bsd":0.99909,"btc":2.2e-05,"btn":75.623346,"busd":0.999222,"bwp":11.417955,"byn":3.254016,"byr":19599.995859,"bzd":2.013815,"cad":1.250124,"cdf":2009.999668,"chf":0.92368,"chz":3.508016,"clf":0.028514,"clp":786.779399,"cny":6.339821,"cop":3765.839204,"crc":654.789965,"cro":2.159587,"cuc":1,"cup":26.499994,"cve":99.950021,"czk":22.054994,"dai":1.000243,"djf":177.719912,"dkk":6.720597,"doge":7.179545,"dop":55.049729,"dot":0.046282,"dzd":143.061548,"egld":0.005293,"egp":18.278801,"enj":0.536025,"ern":15.000002,"etb":51.009924,"etc":0.021073,"eth":0.000303,"eur":0.90343,"fil":0.040582,"fjd":2.097397,"fkp":0.766959,"ftt":0.020411,"gbp":0.760831,"gel":3.104996,"ggp":0.766959,"ghs":7.509721,"gip":0.766959,"gmd":53.750049,"gnf":8874.997972,"grt":2.07972,"gtq":7.677944,"gyd":209.022662,"hkd":7.833148,"hnl":24.370366,"hrk":6.842098,"htg":106.402694,"huf":332.156964,"icp":0.047293,"idr":14350.246968,"ils":3.190544,"imp":0.766959,"inj":0.168481,"inr":75.909434,"iqd":1459.999692,"irr":42249.991482,"isk":128.290477,"jep":0.766959,"jmd":153.366985,"jod":0.708968,"jpy":121.941988,"kes":115.000468,"kgs":82.461973,"khr":4054.999374,"kmf":444.349977,"kpw":900.00016,"krw":1215.994729,"ksm":0.005209,"kwd":0.30395,"kyd":0.832545,"kzt":471.129585,"lak":11749.997465,"lbp":1513.999986,"link":0.058647,"lkr":293.731328,"lrd":152.688127,"lsl":14.639942,"ltc":0.008019,"ltl":2.952739,"luna":218.939058,"lvl":0.60489,"lyd":4.639775,"mad":9.524748,"matic":0.612235,"mdl":18.313095,"mga":3984.999027,"mkd":55.673007,"mmk":1776.524289,"mnt":2878.772183,"mop":8.057118,"mro":356.999752,"mur":45.352694,"mvr":15.44991,"mwk":817.498554,"mxn":19.881846,"myr":4.20475,"mzn":63.829984,"nad":14.639831,"ngn":415.749725,"nio":35.709967,"nok":8.790353,"npr":121.001316,"nzd":1.442535,"omr":0.38501,"one":656.861301,"pab":0.99909,"pen":3.722994,"pgk":3.519854,"php":51.893486,"pkr":183.549901,"pln":4.195321,"pyg":6942.564123,"qar":3.641001,"ron":4.4658,"rsd":106.370628,"rub":81.750148,"rwf":1017.499785,"sar":3.75145,"sbd":8.022494,"scr":14.415225,"sdg":447.499372,"sek":9.390837,"sgd":1.355196,"shib":38221.297761,"shp":1.377402,"sll":11874.997245,"sol":0.008205,"sos":586.000204,"srd":20.733495,"std":20697.976635,"svc":8.741543,"syp":2511.999807,"szl":14.639737,"thb":33.309493,"theta":0.231144,"tjs":12.95818,"tmt":3.51,"tnd":2.937022,"top":2.248503,"trx":13.329024,"try":14.673969,"ttd":6.788373,"twd":28.658696,"tzs":2319.999497,"uah":29.497706,"ugx":3580.710937,"uni":10946.952886,"usd":1,"usdc":0.999503,"usdt":0.999685,"uyu":41.222713,"uzs":11399.99728,"vef":213830177157.1771,"vet":12.64913,"vnd":22840.495174,"vuv":114.116579,"wbtc":2.2e-05,"wst":2.622046,"xaf":590.787133,"xag":0.040336,"xau":0.000517,"xcd":2.702549,"xdr":0.722204,"xlm":4.349485,"xmr":0.004667,"xof":592.494723,"xpf":107.999974,"xrp":1.206952,"yer":250.249653,"zar":14.615497,"zmk":9001.194339,"zmw":18.033518,"zwl":321.999524}},
    "2022-05-01":{"date":"2022-05-01","usd":{"1inch":0.857315,"ada":1.274434,"aed":3.6731,"afn":86.230622,"algo":1.667759,"all":114.85278,"amd":453.259836,"ang":1.808184,"aoa":405.617428,"ars":115.472963,"atom":0.055361,"aud":1.419244,"avax":0.016982,"awg":1.8005,"azn":1.696353,"bam":1.857415,"bbd":2.026024,"bch":0.003497,"bdt":86.95222,"bgn":1.85511,"bhd":0.377407,"bif":2060.533732,"bmd":1,"bnb":0.002565,"bnd":1.384282,"bob":6.907921,"brl":4.9728,"bsd":1.003324,"btc":2.6e-05,"btn":76.405063,"busd":1.00181,"bwp":12.146511,"byn":3.377618,"byr":19599.996369,"bzd":2.022297,"cad":1.28643,"cdf":2012.999365,"chf":0.974503,"chz":5.475616,"clf":0.030896,"clp":852.509912,"cny":6.608194,"cop":3957.999267,"crc":663.896667,"cro":3.178462,"cuc":1,"cup":26.499995,"cve":104.749655,"czk":23.388297,"dai":1.000189,"djf":178.638899,"dkk":7.069849,"doge":7.558978,"dop":55.151248,"dot":0.064872,"dzd":144.916829,"egld":0.007842,"egp":18.525896,"enj":0.917624,"ern":14.999999,"etb":52.028728,"etc":0.03603,"eth":0.000352,"eur":0.950435,"fil":0.066273,"fjd":2.15665,"fkp":0.768642,"ftt":0.025451,"gbp":0.796299,"gel":3.045036,"ggp":0.768642,"ghs":7.625251,"gip":0.768642,"gmd":54.09731,"gnf":8903.57585,"grt":3.187167,"gtq":7.659892,"gyd":209.947966,"hkd":7.847389,"hnl":24.625943,"hrk":7.173497,"htg":109.366135,"huf":359.489479,"icp":0.076983,"idr":14523.94731,"ils":3.341425,"imp":0.768642,"inj":0.273847,"inr":76.520284,"iqd":1464.306811,"irr":42249.991822,"isk":130.980123,"jep":0.768642,"jmd":155.221031,"jod":0.709298,"jpy":130.319474,"kes":116.179868,"kgs":82.101381,"khr":4070.847814,"kmf":465.749437,"kpw":899.999952,"krw":1266.274809,"ksm":0.007526,"kwd":0.306701,"kyd":0.836071,"kzt":446.30673,"lak":12356.268247,"lbp":1519.059185,"link":0.088869,"lkr":351.146774,"lrd":151.500898,"lsl":15.880163,"ltc":0.009997,"ltl":2.95274,"luna":235.072419,"lvl":0.60489,"lyd":4.806951,"mad":10.014861,"matic":0.905372,"mdl":18.672671,"mga":4055.820446,"mkd":58.512926,"mmk":1857.609817,"mnt":2994.862643,"mop":8.109513,"mro":356.999761,"mur":43.800884,"mvr":15.449869,"mwk":822.007549,"mxn":20.449096,"myr":4.353502,"mzn":63.829856,"nad":15.879878,"ngn":415.260394,"nio":35.93437,"nok":9.407002,"npr":122.653931,"nzd":1.55454,"omr":0.385506,"one":788.966835,"pab":1.003357,"pen":3.855175,"pgk":3.53593,"php":52.561992,"pkr":186.293633,"pln":4.44405,"pyg":6865.554125,"qar":3.640961,"ron":4.691006,"rsd":111.663512,"rub":71.10275,"rwf":1021.913495,"sar":3.751298,"sbd":8.035387,"scr":13.47211,"sdg":447.502333,"sek":9.8446,"sgd":1.386724,"shib":46691.779033,"shp":1.3774,"sll":14097.494199,"sol":0.01102,"sos":579.000258,"srd":20.821062,"std":20697.977173,"svc":8.778643,"syp":2512.449026,"szl":15.950025,"thb":34.372496,"theta":0.426437,"tjs":12.454943,"tmt":3.499999,"tnd":3.0525,"top":2.312499,"trx":14.08041,"try":14.858794,"ttd":6.817848,"twd":29.507022,"tzs":2324.999793,"uah":30.349563,"ugx":3566.845656,"uni":8617.704054,"usd":1,"usdc":1.000885,"usdt":0.999864,"uyu":41.458974,"uzs":11212.123164,"vef":213830182726.0315,"vet":20.723895,"vnd":22963.495746,"vuv":112.58163,"wbtc":2.6e-05,"wst":2.585441,"xaf":622.943963,"xag":0.044192,"xau":0.000529,"xcd":2.702549,"xdr":0.748806,"xlm":5.698736,"xmr":0.00468,"xof":623.029756,"xpf":113.324972,"xrp":1.61411,"yer":250.304859,"zar":15.846948,"zmk":9001.196641,"zmw":17.081031,"zwl":321.999532}},
    "2022-06-01":{"date":"2022-06-01","usd":{"1inch":1.034837,"ada":1.590131,"aed":3.6731,"afn":89.000029,"algo":2.37085,"all":62.749912,"amd":447.989908,"ang":1.802111,"aoa":423.356007,"ars":120.191091,"atom":0.096021,"aud":1.390627,"avax":0.037118,"awg":1.8,"azn":1.701984,"bam":1.82846,"bbd":2.018903,"bch":0.004808,"bdt":89.066649,"bgn":1.823823,"bhd":0.377039,"bif":2018.000074,"bmd":1,"bnb":0.003088,"bnd":1.371052,"bob":6.894334,"brl":4.732298,"bsd":0.999916,"btc":3.1e-05,"btn":77.603514,"busd":0.998224,"bwp":12.018156,"byn":3.377367,"byr":19600.000714,"bzd":2.01549,"cad":1.263735,"cdf":2005.999879,"chf":0.9597,"chz":7.970077,"clf":0.029871,"clp":824.209998,"cny":6.672697,"cop":3976.490145,"crc":675.420006,"cro":5.253858,"cuc":1,"cup":26.500001,"cve":103.229919,"czk":23.026795,"dai":0.999195,"djf":177.719653,"dkk":6.93123,"doge":11.533595,"dop":55.150146,"dot":0.096799,"dzd":145.502036,"egld":0.012322,"egp":18.600973,"enj":1.431982,"ern":15.000002,"etb":51.560316,"etc":0.041622,"eth":0.000512,"eur":0.93168,"fil":0.123452,"fjd":2.14415,"fkp":0.818331,"ftt":0.034418,"gbp":0.792805,"gel":3.019549,"ggp":0.818331,"ghs":7.80141,"gip":0.818331,"gmd":54.149697,"gnf":8846.00001,"grt":6.114924,"gtq":7.679328,"gyd":209.191456,"hkd":7.846391,"hnl":24.559809,"hrk":7.027806,"htg":111.98385,"huf":370.215043,"icp":0.11949,"idr":14547.700529,"ils":3.330115,"imp":0.818331,"inj":0.441886,"inr":77.599452,"iqd":1460.000053,"irr":42300.001687,"isk":126.989766,"jep":0.818331,"jmd":153.745484,"jod":0.709017,"jpy":128.881509,"kes":116.849921,"kgs":81.509957,"khr":4061.99995,"kmf":458.650395,"kpw":900.000255,"krw":1241.235039,"ksm":0.012199,"kwd":0.306198,"kyd":0.833232,"kzt":425.322081,"lak":13450.000868,"lbp":1517.000119,"link":0.129707,"lkr":362.466242,"lrd":151.999914,"lsl":15.601532,"ltc":0.014318,"ltl":2.952741,"luna":0.115881,"lvl":0.604889,"lyd":4.755,"mad":9.860503,"matic":1.498245,"mdl":19.043715,"mga":3992.497326,"mkd":57.404657,"mmk":1851.326994,"mnt":3075.77091,"mop":8.081612,"mro":356.999841,"mur":43.099697,"mvr":15.435015,"mwk":1017.000181,"mxn":19.647898,"myr":4.378974,"mzn":63.830309,"nad":15.59408,"ngn":415.19785,"nio":35.849985,"nok":9.369951,"npr":124.165885,"nzd":1.532015,"omr":0.385006,"one":1193.069849,"pab":0.999916,"pen":3.709952,"pgk":3.519724,"php":52.527065,"pkr":199.100954,"pln":4.26965,"pyg":6886.200925,"qar":3.641022,"ron":4.605959,"rsd":109.424996,"rub":62.749753,"rwf":1027.000037,"sar":3.750513,"sbd":8.116969,"scr":13.30457,"sdg":454.999859,"sek":9.761605,"sgd":1.36989,"shib":84886.945881,"shp":1.377402,"sll":13100.000959,"sol":0.021476,"sos":584.503501,"srd":21.122992,"std":20697.981761,"svc":8.749141,"syp":2512.450609,"szl":15.605564,"thb":34.295506,"theta":0.728445,"tjs":11.374269,"tmt":3.51,"tnd":3.030445,"top":2.299201,"trx":11.955353,"try":16.405102,"ttd":6.777104,"twd":28.937501,"tzs":2328.000211,"uah":29.542001,"ugx":3777.27516,"uni":6265.306133,"usd":1,"usdc":0.999662,"usdt":1.000652,"uyu":39.896607,"uzs":10989.999951,"vef":213830230120.83514,"vet":29.757261,"vnd":23190.000844,"vuv":114.265668,"wbtc":3.1e-05,"wst":2.579343,"xaf":613.22161,"xag":0.046365,"xau":0.000545,"xcd":2.70255,"xdr":0.741055,"xlm":6.721773,"xmr":0.004998,"xof":560.499287,"xpf":111.52501,"xrp":2.352913,"yer":250.250438,"zar":15.628935,"zmk":9001.199651,"zmw":17.247959,"zwl":321.999604}},
    "2022-07-01":{"date":"2022-07-01","usd":{"1inch":1.423806,"aave":0.017083,"ada":2.139142,"aed":3.673103,"afn":87.765244,"algo":3.150403,"all":114.575459,"amd":407.209428,"amp":97.361126,"ang":1.801831,"aoa":428.208547,"ar":0.096378,"ars":125.219979,"atom":0.129722,"aud":1.450965,"avax":0.057628,"awg":1.7975,"axs":0.067848,"azn":1.694587,"bam":1.880109,"bat":2.499116,"bbd":2.018697,"bch":0.009545,"bdt":93.454796,"bgn":1.866544,"bhd":0.376983,"bif":2057.802333,"bmd":1,"bnb":0.004486,"bnd":1.392036,"bob":6.883468,"brl":5.253697,"bsd":0.999832,"bsv":0.017928,"btc":4.9e-05,"btcb":4.9e-05,"btg":0.064021,"btn":78.856735,"busd":0.999949,"bwp":12.38903,"byn":3.375837,"byr":19599.997653,"bzd":2.015236,"cad":1.287615,"cake":0.323939,"cdf":2002.500147,"celo":1.147171,"chf":0.955504,"chz":10.120009,"clf":0.033224,"clp":916.750188,"cny":6.699202,"comp":0.020529,"cop":4151.369503,"crc":686.337665,"cro":8.565538,"crv":1.41845,"cuc":1,"cup":26.499997,"cve":105.99396,"cvx":0.226769,"czk":23.618012,"dai":0.99966,"dash":0.023271,"dcr":0.043702,"dfi":31.220184,"djf":177.719504,"dkk":7.101,"doge":14.853228,"dop":54.648043,"dot":0.140112,"dzd":146.321383,"egld":0.019609,"egp":18.803024,"enj":1.942827,"eos":1.059336,"ern":14.999999,"etb":52.143321,"etc":0.065582,"eth":0.000913,"eur":0.95483,"fei":1.005451,"fil":0.182516,"fjd":2.216397,"fkp":0.821099,"flow":0.651469,"frax":0.99782,"ftm":3.903021,"ftt":0.039858,"gala":18.275033,"gbp":0.822659,"gel":2.939898,"ggp":0.821099,"ghs":8.068095,"gip":0.821099,"gmd":54.089828,"gnf":8684.939289,"gno":0.008861,"grt":10.199853,"gt":0.240083,"gtq":7.750909,"gyd":209.165821,"hbar":15.558623,"hkd":7.847249,"hnl":24.573543,"hnt":0.105122,"hot":0.234617,"hrk":7.1913,"ht":0.203803,"htg":114.92551,"huf":378.509568,"icp":0.184295,"idr":14932.498212,"ils":3.500925,"imp":0.821099,"inj":0.797213,"inr":78.97824,"iqd":1459.200517,"irr":42349.995244,"isk":132.430089,"jep":0.821099,"jmd":150.682254,"jod":0.708982,"jpy":135.950485,"kava":0.538462,"kcs":0.100262,"kda":0.636778,"kes":117.87968,"kgs":79.491871,"khr":4066.135871,"klay":4.165955,"kmf":464.624949,"knc":0.781353,"kpw":899.999736,"krw":1291.5848,"ksm":0.020187,"kwd":0.306859,"kyd":0.833241,"kzt":470.251171,"lak":15031.600421,"lbp":1511.907728,"leo":0.173267,"link":0.15722,"lkr":360.422153,"lrc":2.556424,"lrd":152.499112,"lsl":15.840469,"ltc":0.018166,"ltl":2.95274,"luna":0.457905,"lvl":0.604889,"lyd":4.825262,"mad":10.155294,"mana":1.13512,"matic":2.045193,"mdl":19.120903,"mga":4079.113207,"mina":1.605162,"miota":3.672869,"mkd":58.784238,"mkr":0.001092,"mmk":1851.099343,"mnt":3124.087225,"mop":8.079882,"mro":356.999785,"mur":45.751566,"mvr":15.350097,"mwk":1026.213138,"mxn":20.125273,"myr":4.405988,"mzn":63.83017,"nad":15.83965,"near":0.294688,"neo":0.116016,"nexo":1.683835,"ngn":415.269871,"nio":35.847247,"nok":9.845104,"npr":126.170469,"nzd":1.604455,"okb":0.080787,"omr":0.385023,"one":1689.534641,"pab":0.999832,"paxg":0.000552,"pen":3.785729,"pgk":3.568094,"php":55.000493,"pkr":204.00584,"pln":4.485601,"pyg":6850.303186,"qar":3.641013,"qnt":0.017703,"qtum":0.346398,"ron":4.721803,"rsd":112.095007,"rub":54.875018,"rune":0.518342,"rwf":1022.335318,"sand":0.877318,"sar":3.752058,"sbd":8.159967,"scr":14.130641,"sdg":456.507087,"sek":10.238164,"sgd":1.390415,"shib":95952.589561,"shp":1.377401,"sll":13169.998589,"sol":0.029136,"sos":584.494228,"srd":22.343009,"std":20697.97853,"stx":367.502236,"svc":8.748647,"syp":2512.530069,"szl":16.295173,"thb":35.360969,"theta":0.826694,"tjs":9.772708,"tmt":3.509999,"tnd":3.063499,"top":2.34725,"trx":15.218736,"try":16.695498,"ttd":6.78955,"ttt":0.417544,"tusd":0.999131,"twd":29.733898,"tzs":2331.999321,"uah":29.517288,"ugx":3752.180465,"uni":9850.668579,"usd":1,"usdc":0.999584,"usdp":1.001336,"usdt":1.001043,"uyu":39.081969,"uzs":10863.378798,"vef":213830196734.82465,"vet":43.457507,"vnd":23264.997215,"vuv":116.210819,"waves":0.196113,"wbtc":4.9e-05,"wemix":0.35062,"wst":2.644722,"xaf":630.561074,"xag":0.04939,"xau":0.000554,"xcd":2.702549,"xdc":42.342918,"xdr":0.75009,"xec":25728.66191,"xem":25.723357,"xlm":8.779399,"xmr":0.008634,"xof":630.579259,"xpf":113.149639,"xrp":3.020388,"xtz":0.692562,"yer":250.249904,"zar":16.301501,"zec":0.017982,"zil":25.566752,"zmk":9001.199744,"zmw":16.891301,"zwl":321.999553}},
    "2022-08-01":{"date":"2022-08-01","usd":{"1inch":1.303689,"aave":0.010163,"ada":1.915772,"aed":3.673037,"afn":90.000099,"algo":2.954043,"all":114.375047,"amd":407.710115,"amp":109.398465,"ang":1.804927,"aoa":433.264183,"ar":0.063653,"ars":131.200699,"atom":0.095088,"aud":1.431342,"avax":0.041667,"awg":1.800001,"axs":0.055753,"azn":1.698836,"bam":1.912625,"bat":2.43382,"bbd":2.022122,"bch":0.007097,"bdt":94.816735,"bgn":1.914341,"bhd":0.376822,"bif":2041.00096,"bmd":1,"bnb":0.003489,"bnd":1.380808,"bob":6.895337,"brl":5.172797,"bsd":1.001477,"bsv":0.016225,"btc":4.3e-05,"btcb":4.3e-05,"btg":0.034302,"btn":79.342002,"busd":1.000647,"bwp":12.518708,"byn":2.528385,"byr":19600.009223,"bzd":2.018699,"cad":1.280405,"cake":0.250664,"cdf":2000.0005,"celo":0.958794,"chf":0.951385,"chz":8.111671,"clf":0.032657,"clp":901.118015,"cny":6.744199,"comp":0.017289,"cop":4287.002018,"crc":669.789772,"cro":7.235181,"crv":0.75118,"cuc":1,"cup":26.500012,"cve":104.349854,"cvx":0.133624,"czk":24.076711,"dai":1.0004,"dash":0.019474,"dcr":0.036016,"dfi":26.3595,"djf":177.720309,"dkk":7.280613,"doge":14.571883,"dop":54.566196,"dot":0.114522,"dzd":145.846523,"egld":0.017178,"egp":18.908811,"enj":1.605279,"eos":0.741977,"ern":15.000007,"etb":52.15037,"etc":0.027529,"eth":0.000593,"eur":0.977965,"fei":1.016184,"fil":0.098682,"fjd":2.188751,"fkp":0.842337,"flow":0.513634,"frax":1.001147,"ftm":3.003058,"ftt":0.032816,"gala":17.261354,"gbp":0.820585,"gel":2.85011,"ggp":0.842337,"ghs":7.850245,"gip":0.842337,"gmd":53.850123,"gnf":8800.003791,"gno":0.006216,"grt":7.718222,"gt":0.223912,"gtq":7.749053,"gyd":209.526889,"hbar":12.927563,"hkd":7.849663,"hnl":24.560015,"hnt":0.107553,"hot":0.32596,"hrk":7.368306,"ht":0.221189,"htg":117.175071,"huf":395.595247,"icp":0.11096,"idr":14833.00698,"ils":3.409007,"imp":0.842337,"inj":0.690298,"inr":79.195187,"iqd":1460.000688,"irr":42300.020102,"isk":135.639918,"jep":0.842337,"jmd":153.77529,"jod":0.70905,"jpy":132.849966,"kava":0.515657,"kcs":0.098805,"kda":0.482495,"kes":118.899999,"kgs":83.174075,"khr":4083.002082,"klay":3.27024,"kmf":464.625192,"knc":0.642844,"kpw":900.000415,"krw":1305.6456,"ksm":0.015389,"kwd":0.30695,"kyd":0.834548,"kzt":477.875033,"lak":14875.007103,"lbp":1518.000766,"leo":0.199943,"link":0.129512,"lkr":358.525287,"lrc":2.348567,"lrd":152.749759,"lsl":15.839646,"ltc":0.016644,"ltl":2.952741,"luna":0.52072,"lvl":0.60489,"lyd":4.864972,"mad":10.303508,"mana":1.015681,"matic":1.072147,"mdl":19.338942,"mga":4165.002218,"mina":1.275006,"miota":3.098248,"mkd":60.253894,"mkr":0.000901,"mmk":1854.271108,"mnt":3144.661471,"mop":8.0975,"mro":356.999996,"mur":45.549824,"mvr":15.407872,"mwk":1020.00008,"mxn":20.374835,"myr":4.450504,"mzn":63.830013,"nad":15.839897,"near":0.233951,"neo":0.089379,"nexo":1.391561,"ngn":415.87049,"nio":35.849991,"nok":9.668385,"npr":126.947321,"nzd":1.587771,"okb":0.054268,"omr":0.384841,"one":1604.755545,"pab":1.001477,"paxg":0.000567,"pen":3.933502,"pgk":3.525,"php":55.125052,"pkr":207.100673,"pln":4.636703,"pyg":6905.899063,"qar":3.641008,"qnt":0.009551,"qtum":0.241131,"ron":4.833502,"rsd":114.765101,"rub":62.249714,"rune":0.381934,"rwf":1029.000484,"sand":0.759791,"sar":3.755852,"sbd":8.210384,"scr":13.417444,"sdg":456.498483,"sek":10.157895,"sgd":1.380626,"shib":84659.432095,"shp":1.377399,"sll":13170.005821,"sol":0.023176,"sos":585.000538,"srd":24.221032,"std":20697.990748,"stx":325.344306,"svc":8.763047,"syp":2512.530616,"szl":16.578805,"thb":36.313519,"theta":0.737986,"tjs":10.190208,"tmt":3.500001,"tnd":3.134504,"top":2.336851,"trx":14.438121,"try":17.925,"ttd":6.802143,"ttt":0.281903,"tusd":1.000242,"twd":30.014817,"tzs":2330.00084,"uah":36.96762,"ugx":3865.774025,"uni":10696.86277,"usd":1,"usdc":0.99987,"usdp":0.999005,"usdt":0.999717,"uyu":41.592447,"uzs":10935.005348,"vet":36.201664,"vnd":23340.010984,"vuv":118.896081,"waves":0.169719,"wbtc":4.3e-05,"wemix":0.405097,"wst":2.720972,"xaf":641.460306,"xag":0.049385,"xau":0.000567,"xcd":2.702551,"xdc":33.739368,"xdr":0.760513,"xec":22484.602429,"xem":19.975935,"xlm":8.419822,"xmr":0.006487,"xof":643.000504,"xpf":113.150195,"xrp":2.612988,"xtz":0.567787,"yer":250.149891,"zar":16.628288,"zec":0.015309,"zil":22.871129,"zmk":9001.202883,"zmw":16.361991,"zwl":321.999744}},
    "2022-09-01":{"date":"2022-09-01","usd":{"1inch":1.526147,"aave":0.011825,"ada":2.244201,"aed":3.673099,"afn":87.99967,"algo":3.476561,"all":116.499357,"amd":404.560666,"amp":161.608212,"ang":1.800588,"aoa":429.420974,"ar":0.09933,"ars":138.727137,"atom":0.085689,"aud":1.4678,"avax":0.052324,"awg":1.805,"axs":0.071772,"azn":1.702031,"bam":1.958298,"bat":3.005898,"bbd":2.017172,"bch":0.008705,"bdt":94.938897,"bgn":1.946598,"bhd":0.376911,"bif":2047.000589,"bmd":1,"bnb":0.003593,"bnd":1.396828,"bob":6.903504,"brl":5.1834,"bsd":0.999074,"bsv":0.019367,"btc":5e-05,"btcb":5e-05,"btg":0.043711,"btn":79.429175,"busd":0.999771,"bwp":12.841826,"byn":2.521678,"byr":19600.005648,"bzd":2.013768,"cad":1.31635,"cake":0.254906,"cdf":2025.000218,"celo":1.216017,"chf":0.98049,"chz":4.711559,"clf":0.032508,"clp":897.000096,"cny":6.890404,"comp":0.021575,"cop":4421.671274,"crc":639.425452,"cro":8.185475,"crv":0.880325,"cuc":1,"cup":26.500008,"cve":110.102907,"cvx":0.199157,"czk":24.456105,"dai":1.000014,"dash":0.02256,"dcr":0.035216,"dfi":32.319326,"djf":177.719915,"dkk":7.420052,"doge":16.301734,"dop":53.000093,"dot":0.142515,"dzd":140.439071,"egld":0.019176,"egp":19.238705,"enj":1.948772,"eos":0.73805,"ern":15.000004,"etb":52.506201,"etc":0.03095,"eth":0.000644,"eur":0.997451,"fei":1.008671,"fil":0.173942,"fjd":2.238203,"fkp":0.823605,"flow":0.490238,"frax":1.002074,"ftm":3.675041,"ftt":0.037482,"gala":19.92093,"gbp":0.86372,"gel":2.89021,"ggp":0.823605,"ghs":10.075041,"gip":0.823605,"gmd":55.150284,"gnf":8700.002724,"gno":0.006436,"grt":9.785073,"gt":0.233445,"gtq":7.732723,"gyd":209.016557,"hbar":15.958107,"hkd":7.848368,"hnl":24.54012,"hnt":0.190337,"hot":0.432096,"hrk":7.4965,"ht":0.211973,"htg":115.890214,"huf":399.705114,"icp":0.16102,"idr":14844.504277,"ils":3.327776,"imp":0.823605,"inj":0.647979,"inr":79.549173,"iqd":1460.000421,"irr":42350.012231,"isk":141.370025,"jep":0.823605,"jmd":150.488183,"jod":0.709027,"jpy":139.529012,"kava":0.575327,"kcs":0.111391,"kda":0.63176,"kes":120.150045,"kgs":80.699072,"khr":4120.001154,"klay":4.336128,"kmf":490.225156,"knc":0.581788,"kpw":900.000609,"krw":1348.915393,"ksm":0.02121,"kwd":0.30825,"kyd":0.832591,"kzt":472.595607,"lak":15440.004474,"lbp":1515.000068,"leo":0.172613,"link":0.15162,"lkr":354.690875,"lrc":2.871786,"lrd":153.802631,"lsl":16.960063,"ltc":0.018585,"ltl":2.952741,"luna":0.564915,"lvl":0.60489,"lyd":4.925027,"mad":10.562499,"mana":1.299962,"matic":1.190557,"mdl":19.2816,"mga":4125.000947,"mina":1.502404,"miota":3.579542,"mkd":61.286522,"mkr":0.001317,"mmk":2098.244882,"mnt":3194.962484,"mop":8.076665,"mro":356.999931,"mur":44.542199,"mvr":15.359991,"mwk":1024.503323,"mxn":20.215856,"myr":4.48503,"mzn":63.829819,"nad":17.119507,"near":0.230097,"neo":0.112082,"nexo":0.920963,"ngn":421.88018,"nio":36.030259,"nok":9.988063,"npr":127.095428,"nzd":1.640213,"okb":0.065246,"omr":0.384932,"one":1741.390016,"pab":0.999074,"paxg":0.000587,"pen":3.831504,"pgk":3.520258,"php":56.343035,"pkr":218.775092,"pln":4.714244,"pyg":6882.54281,"qar":3.640986,"qnt":0.010342,"qtum":0.322359,"ron":4.830803,"rsd":117.025008,"rub":60.125009,"rune":0.527691,"rwf":1036.500298,"sand":1.072146,"sar":3.759104,"sbd":8.244166,"scr":13.619568,"sdg":579.000409,"sek":10.695988,"sgd":1.399956,"shib":82636.679282,"shp":1.377399,"sll":14125.00395,"sol":0.031692,"sos":568.505441,"srd":25.126031,"std":20697.986972,"stx":318.5518,"svc":8.742149,"syp":2512.531094,"szl":17.115028,"thb":36.654513,"theta":0.866311,"tjs":10.175224,"tmt":3.500001,"tnd":3.194986,"top":2.357804,"trx":15.796762,"try":18.203906,"ttd":6.772737,"ttt":21.239166,"tusd":0.999718,"twd":30.416709,"tzs":2331.000842,"uah":36.879779,"ugx":3796.365532,"uni":9964.420218,"usd":1,"usdc":0.999826,"usdp":1.000167,"usdt":0.999963,"uyu":40.668287,"uzs":10975.002949,"vet":41.464669,"vnd":23462.506761,"vuv":116.056113,"waves":0.224126,"wbtc":5e-05,"wemix":0.477402,"wst":2.667461,"xaf":656.86366,"xag":0.056354,"xau":0.000587,"xcd":2.70255,"xdc":37.424703,"xdr":0.766158,"xec":21700.095231,"xem":22.751887,"xlm":9.598597,"xmr":0.006693,"xof":655.502254,"xpf":119.225048,"xrp":3.049272,"xtz":0.665152,"yer":250.24971,"zar":17.177102,"zec":0.016857,"zil":27.852089,"zmk":9001.219283,"zmw":15.810062,"zwl":321.999685}},
    "2022-10-01":{"date":"2022-10-01","usd":{"1inch":1.730952,"aave":0.013389,"ada":2.305895,"aed":3.673022,"afn":88.504015,"algo":2.808062,"all":118.950436,"amd":405.650514,"amp":203.613654,"ang":1.803199,"aoa":433.405623,"ar":0.106533,"ars":147.301482,"atom":0.076496,"aud":1.561525,"avax":0.058154,"awg":1.800001,"axs":0.079046,"azn":1.703971,"bam":2.004613,"bat":3.296434,"bbd":2.020182,"bch":0.008361,"bdt":101.349827,"bgn":1.996187,"bhd":0.377274,"bif":2048.000559,"bmd":1,"bnb":0.003521,"bnd":1.436097,"bob":6.913043,"brl":5.412472,"bsd":1.000559,"bsv":0.020429,"btc":5.2e-05,"btcb":5.2e-05,"btg":0.04886,"btn":81.484597,"busd":0.999842,"bwp":13.331526,"byn":2.525367,"byr":19600.005347,"bzd":2.0168,"cad":1.383271,"cake":0.211033,"cdf":2045.00092,"celo":1.248607,"chf":0.988699,"chz":4.175729,"clf":0.035082,"clp":968.01066,"cny":7.116042,"comp":0.016349,"cop":4610.011258,"crc":627.742559,"cro":9.123753,"crv":1.089761,"cuc":1,"cup":26.500007,"cve":113.000391,"cvx":0.203837,"czk":25.082911,"dai":1.000204,"dash":0.023763,"dcr":0.0396,"dfi":50.223018,"djf":177.720442,"dkk":7.587652,"doge":16.071818,"dop":53.603901,"dot":0.158488,"dzd":140.824079,"egld":0.02095,"egp":19.538054,"enj":2.203095,"eos":0.837721,"ern":15.000004,"etb":52.60389,"etc":0.036076,"eth":0.000752,"eur":1.019911,"fei":1.013961,"fil":0.176295,"fjd":2.310051,"fkp":0.864597,"flow":0.592075,"frax":1.007498,"ftm":4.440443,"ftt":0.041326,"gala":24.64914,"gbp":0.896862,"gel":2.82504,"ggp":0.864597,"ghs":10.450394,"gip":0.864597,"gmd":55.403868,"gnf":8755.002745,"gno":0.008328,"grt":10.103872,"gt":0.233959,"gtq":7.880759,"gyd":209.3261,"hbar":17.415114,"hkd":7.849853,"hnl":24.760395,"hnt":0.188844,"hot":4.592526,"hrk":7.673706,"ht":0.225547,"htg":121.065369,"huf":431.574158,"icp":0.163212,"idr":15303.704176,"ils":3.558542,"imp":0.864597,"inj":0.591265,"inr":81.638426,"iqd":1460.000399,"irr":42350.011907,"isk":144.160426,"jep":0.864597,"jmd":152.147061,"jod":0.70904,"jpy":144.739079,"kava":0.659371,"kcs":0.109248,"kda":0.720493,"kes":120.850418,"kgs":80.177126,"khr":4130.001478,"klay":5.12878,"kmf":501.450521,"knc":0.849681,"kpw":900.000291,"krw":1440.230776,"ksm":0.02355,"kwd":0.30996,"kyd":0.833799,"kzt":476.391197,"lak":16525.004858,"lbp":1516.943692,"leo":0.241867,"link":0.132044,"lkr":365.661284,"lrc":3.37482,"lrd":153.803816,"lsl":18.080386,"ltc":0.018735,"ltl":2.952741,"luna":0.407097,"lvl":0.604891,"lyd":5.055041,"mad":10.953042,"mana":1.431571,"matic":1.286161,"mdl":19.509588,"mga":4197.001492,"mina":1.699156,"miota":3.458306,"mkd":63.136609,"mkr":0.001351,"mmk":2100.92622,"mnt":3224.442936,"mop":8.089477,"mro":356.999926,"mur":45.746245,"mvr":15.450382,"mwk":1026.000625,"mxn":20.146156,"myr":4.63704,"mzn":63.830395,"nad":18.080382,"near":0.280471,"neo":0.113242,"nexo":1.086869,"ngn":432.370495,"nio":36.000354,"nok":10.886068,"npr":130.36847,"nzd":1.789395,"okb":0.062322,"omr":0.384966,"one":2000.636324,"pab":1.000559,"paxg":0.000604,"pen":3.981505,"pgk":3.520376,"php":58.80152,"pkr":228.103766,"pln":4.951727,"pyg":7072.612742,"qar":3.641039,"qnt":0.007016,"qtum":0.350065,"ron":5.053122,"rsd":119.710407,"rub":60.203706,"rune":0.629048,"rwf":1041.500285,"sand":1.187751,"sar":3.756801,"sbd":8.150097,"scr":13.055636,"sdg":578.503836,"sek":11.082968,"sgd":1.431985,"shib":87968.665796,"shp":1.377405,"sll":15495.004566,"sol":0.030064,"sos":568.503822,"srd":28.589511,"std":20697.986655,"stx":317.512113,"svc":8.755056,"syp":2512.531003,"szl":18.080375,"thb":37.803048,"theta":0.931232,"tjs":9.82997,"tmt":3.510001,"tnd":3.269039,"top":2.427105,"trx":16.319793,"try":18.502043,"ttd":6.797385,"ttt":50.375578,"tusd":0.999907,"twd":31.817612,"tzs":2330.000971,"uah":36.950302,"ugx":3852.927156,"uni":25776.83528,"usd":1,"usdc":1.000043,"usdp":0.997973,"usdt":0.999982,"uyu":41.36819,"uzs":11015.00334,"vet":43.224629,"vnd":23865.006511,"vuv":118.961909,"waves":0.261316,"wbtc":5.2e-05,"wemix":0.56318,"wst":2.725579,"xaf":672.293921,"xag":0.052534,"xau":0.000602,"xcd":2.702551,"xdc":31.338453,"xdr":0.784155,"xec":24249.352925,"xem":24.440826,"xlm":8.738368,"xmr":0.006788,"xof":582.000492,"xpf":66.925056,"xrp":2.104763,"xtz":0.701851,"yer":250.250432,"zar":18.091045,"zec":0.017832,"zil":32.006225,"zmk":9001.206049,"zmw":15.783453,"zwl":321.99968}},
    "2022-11-01":{"date":"2022-11-01","usd":{"1inch":1.622951,"aave":0.011836,"ada":2.452589,"aed":3.6731,"afn":86.502369,"algo":2.803276,"all":118.604816,"amd":395.404861,"amp":206.040362,"ang":1.803325,"aoa":484.817752,"ar":0.095977,"ars":156.906936,"atom":0.069913,"aud":1.561014,"avax":0.051719,"awg":1.8,"axs":0.108336,"azn":1.697201,"bam":1.969379,"bat":3.343219,"bbd":2.004713,"bch":0.008656,"bdt":101.358158,"bgn":1.978755,"bhd":0.377068,"bif":2050.000013,"bmd":1,"bnb":0.003059,"bnd":1.41674,"bob":6.909003,"brl":5.1801,"bsd":1.000595,"bsv":0.020845,"btc":4.9e-05,"btcb":4.9e-05,"btg":0.056082,"btn":82.870075,"busd":0.999948,"bwp":13.466685,"byn":2.527992,"byr":19600.000124,"bzd":2.006052,"cad":1.36159,"cake":0.210608,"cdf":2039.000194,"celo":1.332033,"chf":1.001303,"chz":4.552272,"clf":0.034193,"clp":943.454675,"cny":7.302898,"comp":0.019866,"cop":4938.750032,"crc":618.167542,"cro":8.748632,"crv":1.121171,"cuc":1,"cup":26.500001,"cve":116.874994,"cvx":0.187686,"czk":24.755296,"dai":0.999906,"dash":0.023705,"dcr":0.03659,"dfi":76.942507,"djf":177.719668,"dkk":7.530201,"doge":7.953919,"dop":53.999646,"dot":0.150565,"dzd":140.488019,"egld":0.016933,"egp":24.175503,"enj":2.183394,"eos":0.852546,"ern":15,"etb":53.391196,"etc":0.040767,"eth":0.000636,"eur":1.01115,"fei":1.003986,"fil":0.182646,"fjd":2.280099,"fkp":0.882525,"flow":0.593781,"frax":1.007332,"ftm":4.137835,"ftt":0.038327,"gala":23.280863,"gbp":0.87111,"gel":2.764988,"ggp":0.882525,"ghs":13.898605,"gip":0.882525,"gmd":58.600536,"gnf":8725.000305,"gno":0.007872,"grt":11.78666,"gt":0.217324,"gtq":7.839514,"gyd":209.302093,"hbar":16.686458,"hkd":7.84965,"hnl":24.733798,"hnt":0.246923,"hot":588.834776,"hrk":7.616698,"ht":0.114582,"htg":129.346968,"huf":413.889928,"icp":0.189193,"idr":15617.050099,"ils":3.519335,"imp":0.882525,"inj":0.423128,"inr":82.739251,"iqd":1460.000009,"irr":42400.000696,"isk":144.910184,"jep":0.882525,"jmd":153.422713,"jod":0.708985,"jpy":148.748019,"kava":0.680503,"kcs":0.098957,"kda":0.7268,"kes":121.401918,"kgs":83.504403,"khr":4144.999863,"klay":3.790843,"kmf":498.440038,"knc":1.092694,"kpw":899.999869,"krw":1427.309854,"ksm":0.028662,"kwd":0.309819,"kyd":0.833845,"kzt":467.517171,"lak":16925.000211,"lbp":1522.510159,"leo":0.220169,"link":0.127538,"lkr":365.709843,"lrc":3.611469,"lrd":153.704614,"lsl":18.359464,"ltc":0.018162,"ltl":2.95274,"luna":0.408624,"lvl":0.60489,"lyd":4.989965,"mad":10.953504,"mana":1.467411,"matic":1.109778,"mdl":19.294956,"mga":4279.958944,"mina":1.451009,"miota":3.84031,"mkd":62.334339,"mkr":0.00111,"mmk":2101.152626,"mnt":3359.775182,"mop":8.089235,"mro":356.99983,"mur":43.949154,"mvr":15.420266,"mwk":1021.497638,"mxn":19.804471,"myr":4.730496,"mzn":63.830172,"nad":18.359849,"near":0.318487,"neo":0.116945,"nexo":0.997619,"ngn":438.350079,"nio":36.016151,"nok":10.3912,"npr":132.589225,"nzd":1.717079,"okb":0.058078,"omr":0.385036,"one":1606.270206,"pab":1.000559,"paxg":0.000614,"pen":3.969502,"pgk":3.526296,"php":58.185503,"pkr":220.459803,"pln":4.769949,"pyg":7285.01165,"qar":3.640999,"qnt":0.005989,"qtum":0.346741,"ron":4.964991,"rsd":118.594997,"rub":62.049835,"rune":0.629534,"rwf":1048.500007,"sand":1.110214,"sar":3.757664,"sbd":8.203716,"scr":13.25445,"sdg":571.99994,"sek":11.027802,"sgd":1.414765,"shib":80970.064356,"shp":1.377399,"sll":17175.000125,"sol":0.030486,"sos":568.51128,"srd":29.13501,"std":20697.981139,"stx":268.683404,"svc":8.755324,"syp":2512.53005,"szl":18.393028,"thb":37.999658,"theta":0.847704,"tjs":10.080452,"tmt":3.500001,"tnd":3.237502,"top":2.419449,"trx":15.798036,"try":18.630098,"ttd":6.785351,"ttt":16.905034,"tusd":0.999651,"twd":32.259797,"tzs":2331.999704,"uah":36.950853,"ugx":3801.948321,"uni":975.127673,"usd":1,"usdc":0.999992,"usdp":1.008673,"usdt":1.000116,"uyu":40.808169,"uzs":11183.762928,"vet":41.433973,"vnd":24850.000158,"vuv":125.149892,"waves":0.292509,"wbtc":4.9e-05,"wemix":0.794775,"wst":2.844937,"xaf":660.507904,"xag":0.052094,"xau":0.000612,"xcd":2.70255,"xdc":32.484623,"xdr":0.778464,"xec":26033.468744,"xem":25.259804,"xlm":8.976027,"xmr":0.006678,"xof":660.464676,"xpf":120.149831,"xrp":2.169278,"xtz":0.697831,"yer":250.24996,"zar":18.327299,"zec":0.018914,"zil":32.05567,"zmk":9001.201072,"zmw":16.316248,"zwl":321.999595}},
    "2022-12-01":{"date":"2022-12-01","usd":{"1inch":1.904519,"aave":0.015483,"ada":3.146855,"aed":3.672995,"afn":88.000201,"algo":4.070427,"all":112.049815,"amd":394.493175,"amp":285.228992,"ang":1.801793,"aoa":506.778004,"ar":0.104514,"ars":167.294908,"atom":0.096531,"aud":1.46816,"avax":0.076271,"awg":1.8025,"axs":0.144024,"azn":1.698292,"bam":1.887484,"bat":4.242897,"bbd":2.01851,"bch":0.008849,"bdt":101.625952,"bgn":1.876702,"bhd":0.376992,"bif":2057.000108,"bmd":1,"bnb":0.003365,"bnd":1.366039,"bob":6.922825,"brl":5.1856,"bsd":0.999701,"bsv":0.023584,"bsw":4.701851,"btc":5.8e-05,"btcb":5.8e-05,"btg":0.065718,"btn":81.346547,"busd":1.000309,"bwp":12.833946,"byn":2.524778,"byr":19600.001029,"bzd":2.015036,"cad":1.340485,"cake":0.252955,"cdf":2053.525142,"celo":1.680236,"chf":0.941925,"chz":6.105402,"clf":0.032273,"clp":890.50149,"cny":7.092499,"comp":0.026076,"cop":4830.050254,"crc":596.626198,"cro":15.301457,"crv":1.506745,"cuc":1,"cup":26.500001,"cve":107.409837,"cvx":0.240766,"czk":23.316944,"dai":1.000515,"dash":0.02315,"dcr":0.048658,"dfi":207.968246,"djf":177.719818,"dkk":7.12337,"doge":9.49236,"dop":54.75025,"dot":0.184073,"dzd":138.386654,"egld":0.022882,"egp":24.551202,"enj":3.219362,"eos":1.057726,"ern":15.000001,"etb":53.449926,"etc":0.049807,"eth":0.000776,"eur":0.95776,"fei":1.003503,"fil":0.228314,"fjd":2.20125,"fkp":0.833742,"flow":0.891667,"frax":1.003488,"ftm":4.180401,"ftt":0.751539,"gala":39.251037,"gbp":0.82632,"gel":2.710253,"ggp":0.833742,"ghs":14.502301,"gip":0.833742,"gmd":62.000189,"gnf":8795.000194,"gno":0.010948,"grt":15.572458,"gt":0.273627,"gtq":7.823112,"gyd":209.146805,"hbar":19.845743,"hkd":7.80105,"hnl":24.770126,"hnt":0.410091,"hot":591.343925,"hrk":7.231991,"ht":0.145004,"htg":140.458413,"huf":392.20502,"icp":0.245769,"idr":15627.50082,"ils":3.449802,"imp":0.833742,"inj":0.570937,"inr":81.368505,"iqd":1460.000077,"irr":42450.002597,"isk":143.579774,"jep":0.833742,"jmd":153.983803,"jod":0.709297,"jpy":136.545511,"kava":1.138239,"kcs":0.149198,"kda":1.048461,"kes":122.550114,"kgs":84.448207,"khr":4134.000404,"klay":5.266223,"kmf":477.249991,"knc":1.430472,"kpw":899.90478,"krw":1298.359852,"ksm":0.033595,"kwd":0.30719,"kyd":0.833193,"kzt":468.931131,"lak":17320.001016,"lbp":1516.619582,"leo":0.25439,"link":0.131369,"lkr":368.413016,"lrc":3.976064,"lrd":154.050323,"lsl":16.959771,"ltc":0.012854,"ltl":2.95274,"luna":0.621107,"lvl":0.604891,"lyd":4.897197,"mad":10.713498,"mana":2.443059,"matic":1.083358,"mdl":19.503963,"mga":4360.000419,"mina":1.725935,"miota":4.644466,"mkd":59.190273,"mkr":0.001517,"mmk":2099.392306,"mnt":3424.788421,"mop":8.03322,"mro":356.999847,"mur":44.352545,"mvr":15.330353,"mwk":1029.498701,"mxn":19.267851,"myr":4.407498,"mzn":63.829797,"nad":16.959862,"near":0.571108,"neo":0.143319,"nexo":1.536041,"ngn":443.940238,"nio":36.389849,"nok":9.805091,"npr":130.154861,"nzd":1.58169,"okb":0.045767,"omr":0.38502,"one":1696.286117,"pab":0.999701,"paxg":0.000566,"pen":3.832499,"pgk":3.514965,"php":56.347506,"pkr":223.999875,"pln":4.477673,"pyg":7198.610685,"qar":3.6405,"qnt":0.00822,"qtum":0.450505,"ron":4.708803,"rsd":112.370099,"rub":60.549656,"rune":1.045714,"rwf":1061.000056,"sand":1.708755,"sar":3.759329,"sbd":8.223824,"scr":12.895074,"sdg":568.501157,"sek":10.457051,"sgd":1.357135,"shib":107954.794631,"shp":1.3774,"sle":18.308895,"sll":18330.000461,"sol":0.07173,"sos":569.499211,"srd":31.630502,"std":20697.982094,"stx":314.518971,"svc":8.747726,"syp":2512.379262,"szl":16.960085,"thb":35.019869,"theta":1.054329,"tjs":10.047338,"tmt":3.5,"tnd":3.261498,"top":2.362799,"trx":18.370115,"try":18.622701,"ttd":6.774495,"ttt":17.842153,"tusd":1.000325,"twd":30.665504,"tzs":2332.000093,"uah":36.913755,"ugx":3743.835905,"uni":4853.492544,"usd":1,"usdc":1.000096,"usdp":1.006853,"usdt":0.999963,"uyu":39.525739,"uzs":11220.000306,"vef":1078295.541609,"vet":52.001504,"vnd":24645.001293,"vuv":119.153396,"waves":0.423356,"wbtc":5.8e-05,"wemix":2.231013,"wst":2.734576,"xaf":633.074555,"xag":0.044782,"xau":0.000562,"xcd":2.70255,"xch":0.031785,"xdc":43.326106,"xdr":0.760671,"xec":33816.948795,"xem":30.379226,"xlm":11.166725,"xmr":0.007012,"xof":633.498879,"xpf":116.049922,"xrp":2.47216,"xtz":0.985621,"yer":250.375059,"zar":17.114002,"zec":0.023103,"zil":43.905589,"zmk":9001.197161,"zmw":17.104739,"zwl":321.999609}},
    "2021-01-01":{"usd":{"aed":3.6729,"afn":77.3,"all":100.65,"amd":522.59,"ang":1.79468,"aoa":654.16,"ars":84.07466,"aud":1.303371,"awg":1.8,"azn":1.7,"bam":1.593033,"bbd":2.018668,"bch":0.00295,"bdt":84.63246,"bgn":1.6005,"bhd":0.37698,"bif":1945,"bmd":1,"bnd":1.321197,"bob":6.883568,"brl":5.1936,"bsd":0.999804,"btc":3.5e-05,"btn":73.05201,"bwp":10.80286,"byr":2.612258,"bzd":2.015329,"cad":1.273,"cdf":1971,"chf":0.8983,"clf":0.02444,"clp":710.5,"cnh":6.50478,"cny":6.5327,"cop":3422,"crc":610.2758,"cup":1,"cve":90.5,"czk":21.4704,"djf":177.72,"dkk":6.0919,"dop":58.25,"dzd":132.075,"egp":15.7382,"etb":38.05,"eth":0.001362,"eur":0.8216,"fjd":2.06,"gbp":0.730514,"gel":3.285,"ghs":5.88,"gmd":51.71,"gnf":10015,"gqe":534.2757,"gtq":7.793425,"gyd":209.1712,"hkd":7.75345,"hnl":24.225,"hrk":6.1794,"htg":72.62042,"huf":296.92,"idr":13956.29,"ils":3.21302,"inr":73.07485,"iqd":1462.5,"irr":42105,"isk":127.81,"jmd":142.9716,"jod":0.709,"jpy":103.2405,"kes":109,"kgs":83.5,"khr":4045,"kmf":403,"kpw":3.619,"krw":1085.65,"kwd":0.30415,"kyd":0.833157,"kzt":421.3596,"lak":9300,"lbp":1518,"lkr":185.2116,"lrd":164.275,"lsl":14.69,"ltc":0.008059,"lyd":1.345,"mad":8.9075,"mdl":17.18045,"mga":3825,"mkd":50.1853,"mmk":1327.724,"mnt":2805,"mop":7.983466,"mru":36.515,"mur":39.7,"mvr":15.4,"mwk":770,"mxn":19.8822,"myr":4.0225,"mzm":74.9,"mzn":74.2,"nad":14.69,"ngn":381.2,"nio":34.92,"nok":8.599725,"npr":116.8829,"nzd":1.392176,"omr":0.384937,"pab":0.999804,"pen":3.62,"pgk":3.515,"php":48.095,"pkr":159.6,"pln":3.72715,"pyg":6915.333,"qar":3.64125,"ron":3.9828,"rsd":96.25,"rub":73.9462,"rwf":978.5,"sar":3.751484,"sbd":8.002049,"scr":21.20257,"sdg":55.25,"sek":8.27397,"sgd":1.322,"shp":0.732,"sll":10116.5,"sos":583,"srd":14.154,"svc":8.748595,"syp":1256,"szl":14.69,"thb":29.9875,"tjs":11.3252,"tmt":3.5,"tnd":2.6945,"top":2.27405,"try":7.4388,"ttd":6.76047,"twd":28.099,"tzs":2318.537,"uah":28.32914,"ugx":3655.253,"usd":1,"uyu":11.476242,"uzs":2851.969799,"vef":1105844,"vnd":6283.862813,"vuv":106,"xaf":531.64,"xcd":2.70255,"xof":145.797597,"xpf":98.05,"yer":68.175011,"zar":14.66265,"zmw":5.762694}},
    "2021-02-01":{"usd":{"aed":3.6732,"afn":77.18229,"all":101.8084,"amd":518.27,"ang":1.79345,"aoa":655.668,"ars":87.17591,"aud":1.31145,"awg":1.8,"azn":1.7,"bam":1.61085,"bbd":2.017302,"bch":0.002499,"bdt":84.62171,"bgn":1.61208,"bhd":0.377013,"bif":1940.696,"bmd":1,"bnd":1.327786,"bob":6.89662,"brl":5.4623,"bsd":0.999135,"btc":3e-05,"btn":72.80737,"bwp":10.96132,"byr":2.616354,"bzd":2.013924,"cad":1.279885,"cdf":1974,"chf":0.891635,"clf":0.025233,"clp":734.8,"cnh":6.45361,"cny":6.4278,"cop":3569.01,"crc":612.9022,"cup":23.97073,"cve":91.125,"czk":21.4566,"djf":177.8702,"dkk":6.1352,"dop":57.9691,"dzd":132.9887,"egp":15.7277,"etb":39.39979,"eth":0.000767,"eur":0.824895,"fjd":2.0388,"gbp":0.730085,"gel":3.3,"ghs":5.845,"gmd":51.5,"gnf":10270.98,"gqe":540.4383,"gtq":7.770557,"gyd":208.5887,"hkd":7.75295,"hnl":24.07168,"hrk":6.2356,"htg":72.48198,"huf":294.69,"idr":14034.06,"ils":3.27505,"inr":72.9058,"iqd":1462.5,"irr":42105,"isk":128.76,"jmd":146.4008,"jod":0.709,"jpy":104.715,"kes":110.15,"kgs":84.8,"khr":4059.403,"kmf":405.85,"kpw":3.636,"krw":1119.14,"kwd":0.30283,"kyd":0.832345,"kzt":423.4238,"lak":9335,"lbp":1510.69,"lkr":190.5175,"lrd":170.5,"lsl":15.12,"ltc":0.007775,"lyd":4.457261,"mad":8.95,"mdl":17.24839,"mga":3786.859,"mkd":50.84921,"mmk":1328.828,"mnt":2820,"mop":7.976313,"mru":36.08,"mur":39.6,"mvr":15.4,"mwk":770.5302,"mxn":20.49338,"myr":4.0425,"mzm":75.235,"mzn":74.3,"nad":15.12,"ngn":381.2,"nio":34.86962,"nok":8.59525,"npr":116.5314,"nzd":1.395775,"omr":0.384972,"pab":0.998798,"pen":3.6375,"pgk":3.524779,"php":48.056,"pkr":160.3586,"pln":3.7287,"pyg":6956.869,"qar":3.64075,"ron":4.0207,"rsd":96.85469,"rub":75.8675,"rwf":991.5139,"sar":3.750659,"sbd":8.02131,"scr":21.20371,"sdg":55.275,"sek":8.37567,"sgd":1.33022,"shp":0.7289,"sll":10171,"sos":584,"srd":14.154,"svc":8.739375,"syp":1256,"szl":15.03975,"thb":29.91,"tjs":11.38084,"tmt":3.51,"tnd":2.7025,"top":2.2976,"try":7.284755,"ttd":6.795727,"twd":28.016,"tzs":2319,"uah":28.0964,"ugx":3680.487,"usd":1,"uyu":11.47325,"uzs":2864.668549,"vef":1821348,"vnd":6269.364894,"vuv":106.85,"xaf":538,"xcd":2.70255,"xof":147.130112,"xpf":98.65,"yer":68.169447,"zar":15.1732,"zmw":5.826285}},
    "2021-03-01":{"usd":{"aed":3.67305,"afn":77.5,"all":102.1766,"amd":527.96,"ang":1.794491,"aoa":635.95,"ars":89.7173,"aud":1.2898,"awg":1.8,"azn":1.7,"bam":1.615,"bbd":2.018513,"bch":0.002168,"bdt":84.77053,"bgn":1.613742,"bhd":0.377233,"bif":1960,"bmd":1,"bnd":1.329518,"bob":6.893001,"brl":5.6049,"bsd":0.999719,"btc":2.2e-05,"btn":73.13243,"bwp":10.98585,"byr":2.605281,"bzd":2.015127,"cad":1.269795,"cdf":1987,"chf":0.907635,"clf":0.024717,"clp":723.9,"cnh":6.47196,"cny":6.4789,"cop":3647,"crc":611.7056,"cup":23.9931,"cve":91.04984,"czk":21.664,"djf":177.72,"dkk":6.1516,"dop":57.81312,"dzd":132.9827,"egp":15.68421,"etb":40.34012,"eth":0.000703,"eur":0.827245,"fjd":2.00285,"gbp":0.715635,"gel":3.325,"ghs":5.748365,"gmd":51.25,"gnf":10146.07,"gqe":541.6387,"gtq":7.700241,"gyd":209.1508,"hkd":7.75664,"hnl":24.08096,"hrk":6.2789,"htg":76.00905,"huf":299.76,"idr":14282.68,"ils":3.31348,"inr":73.5964,"iqd":1458.581,"irr":42105,"isk":127.31,"jmd":150.7911,"jod":0.7082,"jpy":106.495,"kes":109.77,"kgs":84.75,"khr":4074,"kmf":405.05,"kpw":3.6477,"krw":1124.87,"kwd":0.30273,"kyd":0.833086,"kzt":417.6163,"lak":9341.31,"lbp":1511.758,"lkr":194.4438,"lrd":173.425,"lsl":14.52,"ltc":0.006034,"lyd":4.440811,"mad":8.941158,"mdl":17.46994,"mga":3721.752,"mkd":50.87776,"mmk":1409.593,"mnt":2820,"mop":7.986607,"mru":35.95,"mur":39.8605,"mvr":15.4,"mwk":781.084,"mxn":20.7938,"myr":4.0545,"mzm":74.87,"mzn":74.1,"nad":14.53,"ngn":381.08,"nio":34.88985,"nok":8.63663,"npr":117.0118,"nzd":1.37545,"omr":0.385128,"pab":0.999719,"pen":3.647444,"pgk":3.555067,"php":48.75539,"pkr":157.7544,"pln":3.73995,"pyg":6620.425,"qar":3.641,"ron":4.01644,"rsd":97.06533,"rub":74.6875,"rwf":992.9978,"sar":3.75045,"sbd":7.981171,"scr":21.13303,"sdg":375.5,"sek":8.4206,"sgd":1.32923,"shp":0.7082,"sll":10196,"sos":586,"srd":14.154,"svc":8.747853,"syp":1256,"szl":14.98869,"thb":30.3565,"tjs":11.3917,"tmt":3.51,"tnd":2.7075,"top":2.272,"try":7.42054,"ttd":6.785655,"twd":27.8695,"tzs":2319,"uah":27.94846,"ugx":3663.958,"usd":1,"uyu":11.721117,"uzs":2864.774459,"vef":1870310,"vnd":6266.318079,"vuv":106.88,"xaf":539.92,"xcd":2.70255,"xof":147.465374,"xpf":98.6,"yer":68.172226,"zar":15.0552,"zmw":5.925373}},
    "2021-04-01":{"usd":{"aed":3.6732,"afn":77.25,"all":104.85,"amd":531.17,"ang":1.794611,"aoa":629.979,"ars":91.9772,"aud":1.316846,"awg":1.8,"azn":1.7,"bam":1.666465,"bbd":2.018703,"bch":0.001848,"bdt":84.77691,"bgn":1.670325,"bhd":0.377029,"bif":1966,"bmd":1,"bnd":1.344297,"bob":6.90851,"brl":5.6328,"bsd":0.999808,"btc":1.7e-05,"btn":73.09797,"bwp":11.07194,"byr":2.622099,"bzd":2.015294,"cad":1.25633,"cdf":1996,"chf":0.94415,"clf":0.024511,"clp":720.5,"cnh":6.56143,"cny":6.5527,"cop":3661.7,"crc":614.1314,"cup":23.99489,"cve":94.3,"czk":22.25985,"djf":177.72,"dkk":6.3421,"dop":56.95,"dzd":133.7989,"egp":15.7168,"etb":40.21,"eth":0.000521,"eur":0.8526,"fjd":2.06365,"gbp":0.725485,"gel":3.4,"ghs":5.785,"gmd":51.25,"gnf":10040,"gqe":558.9153,"gtq":7.710896,"gyd":209.1724,"hkd":7.77475,"hnl":24.12,"hrk":6.4562,"htg":80.25817,"huf":308.6545,"idr":14630,"ils":3.3348,"inr":73.20375,"iqd":1462.5,"irr":42105,"isk":126.79,"jmd":145.6641,"jod":0.709,"jpy":110.758,"kes":109.35,"kgs":84.795,"khr":4045,"kmf":418.9,"kpw":3.7427,"krw":1128.16,"kwd":0.3024,"kyd":0.833145,"kzt":425.5564,"lak":9402,"lbp":1510.878,"lkr":199.4575,"lrd":173.1,"lsl":14.955,"ltc":0.005079,"lyd":4.535,"mad":9.07,"mdl":18.12089,"mga":3785,"mkd":52.53734,"mmk":1409.7,"mnt":2825,"mop":8.005112,"mru":36.03,"mur":40.8,"mvr":15.46,"mwk":785,"mxn":20.43352,"myr":4.1465,"mzm":69.065,"mzn":67.25,"nad":14.955,"ngn":381.5,"nio":35.1,"nok":8.5477,"npr":116.9564,"nzd":1.432439,"omr":0.385007,"pab":0.999808,"pen":3.748,"pgk":3.535,"php":48.53183,"pkr":152.62,"pln":3.95015,"pyg":6443.626,"qar":3.641,"ron":4.1967,"rsd":100.1755,"rub":75.6375,"rwf":980,"sar":3.750757,"sbd":8.000128,"scr":20.63622,"sdg":381,"sek":8.732055,"sgd":1.34522,"shp":0.726,"sll":10222.5,"sos":586,"srd":14.154,"svc":8.748109,"syp":1256,"szl":14.955,"thb":31.253,"tjs":11.39941,"tmt":3.51,"tnd":2.79225,"top":2.29155,"try":8.2596,"ttd":6.786239,"twd":28.449,"tzs":2319,"uah":27.83639,"ugx":3664.203,"usd":1,"uyu":12.121666,"uzs":2858.5431,"vef":1965666,"vnd":6281.988765,"vuv":107.74,"xaf":556,"xcd":2.70255,"xof":152.047269,"xpf":101.84,"yer":68.155835,"zar":14.78564,"zmw":6.009823}},
    "2021-05-01":{"usd":{"aed":3.6731,"afn":77.55,"all":102.4,"amd":520.69,"ang":1.794483,"aoa":654.331,"ars":93.48092,"aud":1.29584,"awg":1.8005,"azn":1.7,"bam":1.618582,"bbd":2.018504,"bch":0.000986,"bdt":84.71867,"bgn":1.624984,"bhd":0.37704,"bif":1963,"bmd":1,"bnd":1.327822,"bob":6.902853,"brl":5.438336,"bsd":0.999694,"btc":1.7e-05,"btn":74.05654,"bwp":10.86033,"byr":2.559419,"bzd":2.015111,"cad":1.229005,"cdf":2001,"chf":0.912809,"clf":0.024096,"clp":710.7,"cnh":6.4729,"cny":6.4745,"cop":3753.31,"crc":617.5344,"cup":23.99257,"cve":91.95,"czk":21.5162,"djf":177.72,"dkk":6.18602,"dop":56.88,"dzd":133.3092,"egp":15.6598,"etb":41.98,"eth":0.00036,"eur":0.83195,"fjd":2.045,"gbp":0.723772,"gel":3.46,"ghs":5.785,"gmd":51.15,"gnf":9902.5,"gqe":542.8445,"gtq":7.715104,"gyd":209.1495,"hkd":7.76745,"hnl":24.15,"hrk":6.279,"htg":85.37369,"huf":299.53,"idr":14442.7,"ils":3.24314,"inr":74.0955,"iqd":1462.5,"irr":42105,"isk":125.31,"jmd":153.3876,"jod":0.7093,"jpy":109.3005,"kes":107.8,"kgs":84.7976,"khr":4050,"kmf":409.35,"kpw":3.785,"krw":1117.76,"kwd":0.30115,"kyd":0.833106,"kzt":429.9712,"lak":9415,"lbp":1514.912,"lkr":197.4387,"lrd":172.05,"lsl":14.47,"ltc":0.003661,"lyd":4.475,"mad":8.9445,"mdl":17.70466,"mga":3775,"mkd":50.9037,"mmk":1557.017,"mnt":2820,"mop":7.995233,"mru":35.985,"mur":40.29,"mvr":15.405,"mwk":792.5,"mxn":20.24285,"myr":4.0955,"mzm":57.58,"mzn":57.02,"nad":14.32,"ngn":380.5,"nio":35.17,"nok":8.31319,"npr":118.4902,"nzd":1.396161,"omr":0.384985,"pab":0.999694,"pen":3.786,"pgk":3.53,"php":48.2398,"pkr":153.85,"pln":3.79275,"pyg":6523.995,"qar":3.641,"ron":4.0978,"rsd":97.32199,"rub":75.2914,"rwf":985,"sar":3.750521,"sbd":7.958647,"scr":13.12682,"sdg":388,"sek":8.454405,"sgd":1.33096,"shp":0.7203,"sll":10235,"sos":584,"srd":14.154,"svc":8.747321,"syp":2510,"szl":14.32,"thb":31.15,"tjs":11.40157,"tmt":3.51,"tnd":2.748,"top":2.2607,"try":8.2884,"ttd":6.790718,"twd":27.8615,"tzs":2318.28,"uah":27.75142,"ugx":3575.891,"usd":1,"uyu":11.969908,"uzs":2870.191408,"vef":2819196,"vnd":6276.714528,"vuv":106,"xaf":542.45,"xcd":2.70255,"xof":147.423158,"xpf":99.45,"yer":68.178106,"zar":14.50157,"zmw":6.080842}},
    "2021-06-01":{"date":"2021-06-01","usd":{"aed":3.6728,"afn":78.35657,"all":100.934,"amd":520.61,"ang":1.795203,"aoa":642,"ars":94.59932,"aud":1.29115,"awg":1.8,"azn":1.7,"bam":1.604566,"bbd":2.019255,"bch":0.001392,"bdt":84.80296,"bgn":1.598905,"bhd":0.377031,"bif":1971.187,"bmd":1,"bnd":1.322488,"bob":6.90565,"brl":5.2182,"bsd":1.00007,"btc":2.7e-05,"btn":72.52836,"bwp":10.62798,"byr":2.533401,"bzd":2.015891,"cad":1.205705,"cdf":2002,"chf":0.89849,"clf":0.024415,"clp":722.9,"cnh":6.36747,"cny":6.37,"cop":3708,"crc":616.7862,"cup":24.00225,"cve":90.4616,"czk":20.7919,"djf":177.72,"dkk":6.0812,"dop":56.88502,"dzd":133.1739,"egp":15.695,"etb":43.5292,"eth":0.000366,"eur":0.817685,"fjd":2.0289,"gbp":0.70287,"gel":3.26,"ghs":5.79056,"gmd":51.18,"gnf":9800.93,"gqe":538.1483,"gtq":7.7272,"gyd":209.2353,"hkd":7.761205,"hnl":24.03121,"hrk":6.1391,"htg":90.58384,"huf":283.856,"idr":14247.65,"ils":3.24851,"inr":72.48765,"iqd":1459.134,"irr":42105,"isk":120.69,"jmd":149.0941,"jod":0.709,"jpy":109.401,"kes":107.71,"kgs":83.6164,"khr":4068.372,"kmf":404.375,"kpw":3.8271,"krw":1108.255,"kwd":0.30077,"kyd":0.833446,"kzt":428.3974,"lak":9445.86,"lbp":1508.309,"lkr":197.7687,"lrd":171.65,"lsl":13.775,"ltc":0.0052,"lyd":4.453879,"mad":8.848607,"mdl":17.62166,"mga":3753.683,"mkd":50.38969,"mmk":1646.155,"mnt":2829,"mop":7.993831,"mru":36.12,"mur":41.3,"mvr":15.45,"mwk":797.5757,"mxn":19.92456,"myr":4.1238,"mzm":60.965,"mzn":60.4,"nad":13.775,"ngn":413,"nio":35.18293,"nok":8.311065,"npr":116.045,"nzd":1.37425,"omr":0.384988,"pab":1.000152,"pen":3.814376,"pgk":3.511566,"php":47.6565,"pkr":154.1646,"pln":3.662595,"pyg":6772.252,"qar":3.641,"ron":4.0214,"rsd":96.48335,"rub":73.4071,"rwf":997.5921,"sar":3.751033,"sbd":7.968254,"scr":14.70579,"sdg":419.5,"sek":8.28958,"sgd":1.31994,"shp":0.705,"sll":10250,"sos":585,"srd":14.154,"svc":8.751225,"syp":2510,"szl":13.76134,"thb":31.188,"tjs":11.33607,"tmt":3.5,"tnd":2.7255,"top":2.23145,"try":8.49012,"ttd":6.797931,"twd":27.5525,"tzs":2319.218,"uah":27.47632,"ugx":3546.351,"usd":1,"uyu":11.944385,"uzs":2877.698148,"vef":3096988,"vnd":6275.865681,"vuv":106.17,"xaf":530.9,"xcd":2.70255,"xof":146.522622,"xpf":98.35,"yer":68.067958,"zar":13.72605,"zmw":6.128063}},
    "2021-07-01":{"date":"2021-07-01","usd":{"aed":3.6732,"afn":79.5,"all":102.7,"amd":495.86,"ang":1.795544,"aoa":646,"ars":95.718,"aud":1.335114,"awg":1.8,"azn":1.7,"bam":1.643182,"bbd":2.019693,"bch":0.001918,"bdt":84.8739,"bgn":1.649415,"bhd":0.377021,"bif":1986,"bmd":1,"bnd":1.344418,"bob":6.916944,"brl":4.9706,"bsd":1.000269,"btc":2.9e-05,"btn":74.2879,"bwp":10.93214,"byn":2.53119,"bzd":2.016265,"cad":1.239745,"cdf":2000,"chf":0.925455,"clf":0.024648,"clp":732.2,"cnh":6.46872,"cny":6.4572,"cop":3750,"crc":619.5737,"cup":24.00679,"cve":93.35,"czk":21.5127,"djf":177.72,"dkk":6.2735,"dop":57.13,"dzd":134.3443,"egp":15.6987,"etb":43.7,"eth":0.000444,"eur":0.843645,"fjd":2.07045,"gbp":0.72328,"gel":3.155,"ghs":5.89,"gmd":51.13,"gnf":9840,"gqe":551.1016,"gtq":7.752275,"gyd":209.0853,"hkd":7.76453,"hnl":24,"hrk":6.322,"htg":93.52673,"huf":296.483,"idr":14545.7,"ils":3.25879,"inr":74.37115,"iqd":1460.5,"irr":42105,"isk":123.76,"jmd":151.0426,"jod":0.709,"jpy":111.093,"kes":107.95,"kgs":84.7009,"khr":4085,"kmf":415.6,"kpw":3.8398,"krw":1130.105,"kwd":0.30085,"kyd":0.833585,"kzt":428.8691,"lak":9495,"lbp":1531.193,"lkr":199.5587,"lrd":171.45,"lsl":14.29,"ltc":0.007008,"lyd":4.5,"mad":8.9335,"mdl":17.96517,"mga":3930,"mkd":51.9561,"mmk":1646.484,"mnt":2821,"mop":7.998975,"mru":36.2,"mur":43,"mvr":15.35,"mwk":808.5,"mxn":19.94128,"myr":4.1545,"mzm":63.47,"mzn":62.85,"nad":14.29,"ngn":411.5,"nio":35.25,"nok":8.61087,"npr":118.8618,"nzd":1.429985,"omr":0.384983,"pab":1.000269,"pen":3.84,"pgk":3.515,"php":48.95,"pkr":158.1,"pln":3.8165,"pyg":6745.388,"qar":3.641,"ron":4.1566,"rsd":98.80531,"rub":73.14,"rwf":984.5,"sar":3.750448,"sbd":8.022495,"scr":14.84299,"sdg":453,"sek":8.55812,"sgd":1.34521,"shp":0.7216,"sll":10260,"sos":585,"srd":20.8655,"svc":8.752636,"syp":2510,"szl":14.29,"thb":32.0325,"tjs":11.40834,"tmt":3.51,"tnd":2.773,"top":2.251,"try":8.7069,"ttd":6.796384,"twd":27.8367,"tzs":2319,"uah":27.18652,"ugx":3553.059,"usd":1,"uyu":11.844553,"uzs":2884.406109,"vef":3200074,"vnd":6265.926475,"vuv":108.55,"xaf":547.78,"xcd":2.70255,"xof":150.277694,"xpf":101.1,"yer":68.128611,"zar":14.2814,"zmw":6.168752}},
    "2021-08-01":{"date":"2021-08-01","usd":{"aed":3.6732,"afn":79.81785,"all":102.4441,"amd":486.24,"ang":1.794893,"aoa":638.622,"ars":96.72259,"aud":1.36147,"awg":1.8,"azn":1.7,"bam":1.643265,"bbd":2.018971,"bch":0.001831,"bdt":84.89426,"bgn":1.649614,"bhd":0.377096,"bif":1981.869,"bmd":1,"bnd":1.352955,"bob":6.904496,"brl":5.208867,"bsd":0.999908,"btc":2.4e-05,"btn":74.30941,"bwp":11.01259,"byn":2.494854,"bzd":2.015527,"cad":1.247735,"cdf":2001,"chf":0.905458,"clf":0.025428,"clp":756.65,"cnh":6.474,"cny":6.4615,"cop":3878,"crc":619.7394,"cup":23.99837,"cve":92.64332,"czk":21.48385,"djf":177.72,"dkk":6.267705,"dop":57.01599,"dzd":134.694,"ecs":0.8423,"eek":0.8423,"egp":15.70995,"ern":0.8423,"etb":44.30084,"eth":0.000394,"eur":0.842673,"fjd":2.08425,"gbp":0.719166,"gel":3.085,"ghs":5.979617,"gip":0.7188,"gmd":51.15,"gnf":9764.327,"gqe":551.1271,"gtq":7.749473,"gyd":208.8287,"hkd":7.772155,"hnl":23.72354,"hrk":6.3205,"htg":95.95197,"huf":301.915,"idr":14439.7,"ils":3.22686,"inr":74.3793,"iqd":1458.902,"irr":42105,"isk":123.7,"jmd":155.0693,"jod":0.709,"jpy":109.685,"kes":108.6,"kgs":84.7585,"khr":4070.71,"kmf":416,"kpw":4.0584,"krw":1151.93,"kwd":0.30045,"kyd":0.833298,"kzt":425.5131,"lak":9546.383,"lbp":1511.918,"lkr":199.4866,"lrd":171.65,"lsl":14.84,"ltc":0.006934,"lyd":4.508196,"mad":8.895405,"mdl":17.89877,"mga":3815.755,"mkd":51.69676,"mmk":1645.889,"mnt":2838,"mop":8.00657,"mru":36.12,"mur":42.46229,"mvr":15.45,"mwk":812.4558,"mxn":19.8817,"myr":4.22,"mzm":63.63,"mzn":63,"nad":14.84,"ngn":411.47,"nio":35.11229,"nok":8.81705,"npr":118.895,"nzd":1.434094,"omr":0.385135,"pab":0.999992,"pen":3.924349,"pgk":3.510977,"php":49.99663,"pkr":162.589,"pln":3.848775,"pyg":6906.008,"qar":3.641,"ron":4.1417,"rsd":98.78509,"rub":73.1494,"rwf":1007.335,"sar":3.750347,"sbd":8.061372,"scr":14.37634,"sdg":446.5,"sek":8.5949,"sgd":1.354345,"shp":0.716,"sll":10255,"sos":585,"srd":21.405,"ssp":0.716,"std":443.8242,"stn":22950,"svc":8.749716,"syp":2511,"szl":14.56449,"thb":33.084,"tjs":11.40421,"tmt":3.51,"tnd":2.7905,"top":2.25615,"try":8.454,"ttd":6.793339,"twd":27.9403,"tzs":2318.843,"uah":26.83006,"ugx":3552.734,"usd":1,"uyu":43.80235,"uzs":10641.72,"vef":3983858,"ves":4005606.64,"vnd":22955,"vuv":109.92,"wst":0.8423,"xaf":549.64,"xag":0.8423,"xcd":2.70255,"xof":551.1271,"xpd":100.37,"xpf":101.45,"xpt":0.8423,"yer":250.1,"zar":14.604,"zmw":19.23375}},
    "2021-09-01":{"date":"2021-09-01","usd":{"aed":3.6732,"afn":85.93066,"all":103.0149,"amd":493.12,"ang":1.793602,"aoa":634.527,"ars":97.7413,"aud":1.365868,"awg":1.8005,"azn":1.7,"bam":1.651486,"bbd":2.017538,"bch":0.001569,"bdt":85.15843,"bgn":1.6562,"bhd":0.376978,"bif":1983.222,"bmd":1,"bnd":1.342537,"bob":6.899612,"brl":5.1507,"bsd":0.999168,"btc":2.1e-05,"btn":72.90347,"bwp":11.05262,"byn":2.515442,"bzd":2.014042,"cad":1.261225,"cdf":1997,"chf":0.9157,"clf":0.025924,"clp":776.03,"cnh":6.45323,"cny":6.4607,"cop":3769.15,"crc":621.3454,"cup":23.97982,"cve":93.10681,"czk":21.5202,"djf":177.72,"dkk":6.29689,"dop":56.88507,"dzd":135.571,"ecs":0.8466,"eek":0.8466,"egp":15.69874,"ern":0.8467,"etb":45.64566,"eth":0.00029,"eur":0.846775,"fjd":2.0899,"gbp":0.727045,"gel":3.12,"ghs":6.0401,"gip":0.7269,"gmd":51.18,"gnf":9782.105,"gqe":553.8657,"gtq":7.731378,"gyd":208.9228,"hkd":7.77705,"hnl":23.85699,"hrk":6.3425,"htg":96.98336,"huf":295.47,"idr":14222,"ils":3.20415,"inr":72.99775,"iqd":1457.862,"irr":42190,"isk":126,"jmd":151.3221,"jod":0.709,"jpy":110.0775,"kes":109.81,"kgs":84.7,"khr":4070.082,"kmf":419,"kpw":4.0766,"krw":1157.355,"kwd":0.3007,"kyd":0.832626,"kzt":426.1685,"lak":9576.485,"lbp":1510.823,"lkr":199.3324,"lrd":171.85,"lsl":14.92,"ltc":0.005864,"lyd":4.515636,"mad":8.933492,"mdl":17.61527,"mga":3915.84,"mkd":52.10322,"mmk":1644.617,"mnt":2839,"mop":8.008106,"mru":36.07,"mur":43.05,"mvr":15.45,"mwk":811.8553,"mxn":20.07225,"myr":4.1535,"mzm":63.75,"mzn":63.43,"nad":14.92,"ngn":411.5,"nio":35.08699,"nok":8.691,"npr":116.6386,"nzd":1.41755,"omr":0.384987,"pab":0.999168,"pen":4.080252,"pgk":3.508243,"php":49.6405,"pkr":166.7348,"pln":3.831505,"pyg":6914.136,"qar":3.641,"ron":4.1782,"rsd":99.28353,"rub":73.3506,"rwf":1008.237,"sar":3.750646,"sbd":8.058065,"scr":12.96449,"sdg":443.5,"sek":8.62164,"sgd":1.3442,"shp":0.7261,"sll":10325,"sos":585,"srd":21.339,"ssp":0.7261,"std":440.0162,"stn":22775,"svc":8.742828,"syp":2511,"szl":14.52167,"thb":32.2,"tjs":11.33072,"tmt":3.51,"tnd":2.7895,"top":2.2597,"try":8.3205,"ttd":6.788261,"twd":27.5837,"tzs":2317.05,"uah":26.90293,"ugx":3532.263,"usd":1,"uyu":42.51196,"uzs":10644.59,"vef":4080269,"ves":4116706.665,"vnd":22782.5,"vuv":110.12,"wst":0.8467,"xaf":549.78,"xag":0.8468,"xcd":2.70255,"xof":553.8797,"xpd":100.91,"xpf":101.88,"xpt":0.8467,"xrp":100.79,"yer":250.85,"zar":14.51922,"zmw":15.91213}},
    "2021-10-01":{"date":"2021-10-01","usd":{"ada":0.468261,"aed":3.6732,"afn":88.19062,"all":105.149901,"amd":484.17914,"ang":1.795043,"aoa":599.167886,"ars":98.728435,"aud":1.381625,"awg":1.800499,"azn":1.685453,"bam":1.690322,"bbd":2.019108,"bch":0.001976,"bdt":85.652596,"bgn":1.688909,"bhd":0.377016,"bif":1994.999542,"bmd":1,"bnb":0.002568,"bnd":1.361622,"bob":6.905049,"brl":5.443493,"bsd":1.000004,"btc":2.3e-05,"btn":74.201569,"bwp":11.338243,"byn":2.51252,"byr":19599.995504,"bzd":2.015737,"cad":1.268285,"cdf":1999.999438,"chf":0.93282,"clf":0.029386,"clp":810.83038,"cny":6.446497,"cop":3810.369126,"crc":625.765243,"cuc":1,"cup":26.499994,"cve":95.450408,"czk":21.898096,"djf":177.719892,"dkk":6.425598,"doge":4.86753,"dop":56.449875,"dzd":137.595948,"egp":15.719158,"ern":15.00495,"etb":46.197367,"etc":0.021135,"eth":0.00033,"eur":0.864055,"fjd":2.110202,"fkp":0.72248,"gbp":0.74245,"gel":3.110212,"ggp":0.72248,"ghs":6.0498,"gip":0.72248,"gmd":51.468865,"gnf":9769.997601,"gtq":7.739121,"gyd":209.083908,"hkd":7.786648,"hnl":24.179719,"hrk":6.471301,"htg":98.001438,"huf":310.138968,"idr":14328.646713,"ils":3.22641,"imp":0.72248,"inr":74.255433,"iqd":1459.499666,"irr":42189.990143,"isk":130.559452,"jep":0.722479,"jmd":147.504666,"jod":0.709007,"jpy":111.391957,"kes":110.499402,"kgs":84.805619,"khr":4096.499963,"kmf":425.549998,"kpw":899.999808,"krw":1185.854667,"kwd":0.30167,"kyd":0.833395,"kzt":426.216234,"lak":9974.997275,"lbp":1527.999638,"link":0.041475,"lkr":199.755977,"lrd":94.505447,"lsl":15.130136,"ltc":0.006486,"ltl":2.952739,"lvl":0.60489,"lyd":4.559743,"mad":9.065495,"mdl":17.600345,"mga":3949.998934,"mkd":53.202821,"mmk":1871.558286,"mnt":2839.237135,"mop":8.022953,"mro":356.999746,"mur":42.639769,"mvr":15.44975,"mwk":815.000256,"mxn":20.619297,"myr":4.1825,"mzn":63.829602,"nad":15.129861,"ngn":410.80904,"nio":35.24978,"nok":8.744473,"npr":118.722614,"nzd":1.44917,"omr":0.384978,"pab":1.000004,"pen":4.138495,"pgk":3.534963,"php":50.990482,"pkr":170.74988,"pln":3.980309,"pyg":6885.204652,"qar":3.641011,"ron":4.275697,"rsd":101.61916,"rub":72.756781,"rwf":997.499771,"sar":3.751206,"sbd":8.061297,"scr":13.262644,"sdg":440.999558,"sek":8.763696,"sgd":1.358601,"shp":1.377402,"sll":10584.997197,"sos":584.99952,"srd":21.398493,"std":20697.97626,"svc":8.75036,"syp":1257.437931,"szl":15.129979,"thb":33.670151,"theta":0.196003,"tjs":11.335402,"tmt":3.499999,"tnd":2.832502,"top":2.276149,"trx":11.10149,"try":8.889699,"ttd":6.792786,"twd":27.849682,"tzs":2299.999303,"uah":26.614633,"ugx":3560.127611,"usd":1,"usdt":0.994256,"uyu":42.836453,"uzs":10699.997376,"vef":213830173291.84598,"vnd":22759.994779,"vuv":111.631706,"wst":2.560319,"xaf":566.919334,"xag":0.045264,"xau":0.00057,"xcd":2.702549,"xdr":0.707485,"xlm":3.54434,"xof":560.494459,"xpf":103.449803,"xrp":1.039893,"yer":250.249989,"zar":15.086002,"zmk":9001.195878,"zmw":16.739935,"zwl":321.999518}},
    "2021-11-01":{"date":"2021-11-01","usd":{"ada":0.506027,"aed":3.67292,"afn":90.650304,"all":105.249894,"amd":477.807081,"ang":1.802739,"aoa":596.999721,"ars":99.73176,"aud":1.32936,"awg":1.8005,"azn":1.706089,"bam":1.678759,"bbd":2.019579,"bch":0.001669,"bdt":85.654456,"bgn":1.692075,"bhd":0.377027,"bif":1997.999904,"bmd":1,"bnb":0.001893,"bnd":1.346152,"bob":6.896557,"brl":5.63775,"bsd":1.000219,"btc":1.6e-05,"btn":74.907318,"bwp":11.398615,"byn":2.425399,"byr":19599.999059,"bzd":2.016145,"cad":1.237765,"cdf":2012.000102,"chf":0.916189,"clf":0.029482,"clp":813.497788,"cny":6.4057,"cop":3759.999819,"crc":637.872326,"cuc":1,"cup":26.499999,"cve":94.698519,"czk":22.205149,"djf":177.719794,"dkk":6.43675,"doge":3.607998,"dop":56.454963,"dzd":137.656445,"egp":15.717882,"ern":15.001238,"etb":47.149863,"etc":0.018278,"eth":0.000231,"eur":0.865275,"fjd":2.079857,"fkp":0.733222,"gbp":0.73067,"gel":3.149858,"ggp":0.733222,"ghs":6.090078,"gip":0.733222,"gmd":52.00028,"gnf":9634.999776,"gtq":7.74176,"gyd":209.373877,"hkd":7.78013,"hnl":24.17989,"hrk":6.490011,"htg":100.523151,"huf":311.589831,"idr":14228.549316,"ils":3.15743,"imp":0.733222,"inr":74.928546,"iqd":1459.99993,"irr":42249.997736,"isk":129.750149,"jep":0.733222,"jmd":153.764868,"jod":0.708984,"jpy":114.181497,"kes":111.191537,"kgs":84.801634,"khr":4064.999811,"kmf":421.413511,"kpw":899.999657,"krw":1174.609914,"kwd":0.30167,"kyd":0.83353,"kzt":428.039857,"lak":10259.999529,"lbp":1531.999528,"link":0.033005,"lkr":202.052857,"lrd":151.499091,"lsl":15.119986,"ltc":0.00517,"ltl":2.95274,"lvl":0.604889,"lyd":4.549617,"mad":9.028503,"mdl":17.443446,"mga":3962.504546,"mkd":52.888182,"mmk":1795.471178,"mnt":2850.92431,"mop":8.012188,"mro":356.999811,"mur":43.058185,"mvr":15.450405,"mwk":814.999743,"mxn":20.54715,"myr":4.141027,"mzn":63.830339,"nad":15.119803,"ngn":410.309676,"nio":35.203341,"nok":8.447134,"npr":119.856132,"nzd":1.393265,"omr":0.385059,"pab":1.000219,"pen":3.9775,"pgk":3.535003,"php":50.539306,"pkr":172.150194,"pln":3.99099,"pyg":6914.819776,"qar":3.641012,"ron":4.27735,"rsd":100.922309,"rub":70.841946,"rwf":999.999952,"sar":3.751099,"sbd":8.032174,"scr":14.736487,"sdg":440.501219,"sek":8.595069,"sgd":1.349098,"shp":1.3774,"sll":10774.999814,"sos":583.999833,"srd":21.50697,"std":20697.980014,"svc":8.751593,"syp":1256.971963,"szl":15.120256,"thb":33.314998,"theta":0.138078,"tjs":11.247451,"tmt":3.505,"tnd":2.8125,"top":2.23345,"trx":9.821253,"try":9.591825,"ttd":6.780081,"twd":27.831696,"tzs":2305.000056,"uah":26.261216,"ugx":3554.798142,"usd":1,"usdt":0.997401,"uyu":43.706248,"uzs":10689.999214,"vef":213830212063.53113,"vnd":22751.498907,"vuv":112.296428,"wst":2.576993,"xaf":563.045943,"xag":0.042026,"xau":0.000562,"xcd":2.70255,"xdr":0.707631,"xlm":2.672318,"xof":565.498295,"xpf":102.502431,"xrp":0.89311,"yer":250.250027,"zar":15.227301,"zmk":9001.195612,"zmw":17.268946,"zwl":321.999577}},
    "2021-12-01":{"date":"2021-12-01","usd":{"ada":0.634419,"aed":3.673096,"afn":96.249642,"all":106.75035,"amd":486.2797,"ang":1.795052,"aoa":565.137818,"ars":100.940865,"aud":1.403055,"awg":1.799999,"azn":1.730784,"bam":1.723608,"bbd":2.019158,"bch":0.001738,"bdt":85.797209,"bgn":1.72441,"bhd":0.377022,"bif":1992.999308,"bmd":1,"bnb":0.001591,"bnd":1.367492,"bob":6.88516,"brl":5.624187,"bsd":1.000062,"btc":1.7e-05,"btn":75.104977,"bwp":11.751161,"byn":2.547059,"byr":19599.993199,"bzd":2.015721,"cad":1.277875,"cdf":2002.999054,"chf":0.919195,"clf":0.029985,"clp":827.379629,"cny":6.364302,"cop":3994.998614,"crc":628.017019,"cuc":1,"cup":26.499991,"cve":98.197598,"czk":22.521091,"djf":177.720297,"dkk":6.561302,"doge":4.590609,"dop":56.49859,"dzd":138.97774,"egp":15.752397,"ern":15.000305,"etb":47.2597,"etc":0.020437,"eth":0.000212,"eur":0.882285,"fjd":2.12905,"fkp":0.745434,"gbp":0.75195,"gel":3.119848,"ggp":0.745434,"ghs":6.12969,"gip":0.745434,"gmd":52.402181,"gnf":9324.996503,"gtq":7.73523,"gyd":209.336069,"hkd":7.797883,"hnl":24.170143,"hrk":6.641194,"htg":98.622545,"huf":321.738388,"idr":14319.995031,"ils":3.150274,"imp":0.745434,"inr":75.075124,"iqd":1460.999493,"irr":42274.985548,"isk":129.510016,"jep":0.745434,"jmd":155.524168,"jod":0.709013,"jpy":113.192964,"kes":112.518229,"kgs":84.788774,"khr":4068.998865,"kmf":436.374846,"kpw":900.000038,"krw":1183.759868,"kwd":0.30235,"kyd":0.833414,"kzt":440.117233,"lak":10859.995732,"lbp":1532.99919,"link":0.039108,"lkr":202.755298,"lrd":142.050393,"lsl":16.084982,"ltc":0.004757,"ltl":2.952739,"lvl":0.60489,"lyd":4.59503,"mad":9.269496,"mdl":17.7011,"mga":3989.998571,"mkd":54.343301,"mmk":1793.546918,"mnt":2858.21762,"mop":8.031618,"mro":356.999704,"mur":43.504665,"mvr":15.450067,"mwk":816.504002,"mxn":21.430594,"myr":4.204502,"mzn":63.830144,"nad":16.079921,"ngn":409.889834,"nio":35.225038,"nok":9.053347,"npr":120.167751,"nzd":1.465265,"omr":0.385014,"pab":1.000062,"pen":4.063012,"pgk":3.52975,"php":50.395009,"pkr":176.249603,"pln":4.109637,"pyg":6831.490584,"qar":3.641026,"ron":4.366294,"rsd":103.286564,"rub":74.150075,"rwf":1004.999651,"sar":3.751621,"sbd":8.06456,"scr":13.565059,"sdg":437.501464,"sek":9.024086,"sgd":1.36546,"shp":1.377403,"sll":11122.499524,"sos":584,"srd":21.511015,"std":20697.973826,"svc":8.750978,"syp":1256.783122,"szl":16.080306,"thb":33.693492,"theta":0.148443,"tjs":11.295382,"tmt":3.499999,"tnd":2.874499,"top":2.285549,"trx":10.238768,"try":13.505021,"ttd":6.770771,"twd":27.592981,"tzs":2299.999269,"uah":27.150741,"ugx":3565.107336,"usd":1,"usdt":0.992394,"uyu":44.185826,"uzs":10779.99645,"vef":213830148142.21887,"vnd":22693.492126,"vuv":111.319571,"wst":2.563641,"xaf":578.072998,"xag":0.043761,"xau":0.000563,"xcd":2.702549,"xdr":0.715324,"xlm":2.92764,"xof":578.999863,"xpf":105.902348,"xrp":0.987997,"yer":250.249702,"zar":15.902839,"zmk":9001.186187,"zmw":17.815579,"zwl":321.99948}}
}

def print_(message, severity="INFO"):
    # Set account id in the beginning of your CF call
    try:
        print(json.dumps({"accountId":ACCOUNTID_LOG, "severity":severity,
                          "message": message, "cloudFunctionExecutionId": str(CF_EXECUTION_ID)}))
    except:
        print(message)

def create_dataset(client, datasetName, accountid=""):
    dataset_id = "{}.{}".format(os.environ.get('GCP_PROJECT', 'ccm-play'), datasetName)
    dataset = bigquery.Dataset(dataset_id)
    dataset.location = "US"
    # Do not change this format for description
    dataset.description = "Dataset for [ AccountId: %s ]" % (accountid)

    # Send the dataset to the API for creation, with an explicit timeout.
    # Raises google.api_core.exceptions.Conflict if the Dataset already
    # exists within the project.
    try:
        dataset = client.create_dataset(dataset, timeout=30)  # Make an API request.
        print_("Created dataset {}.{}".format(client.project, dataset.dataset_id))
    except Exception as e:
        print_("Dataset {} description {}, already exists {}".format(dataset_id, dataset.description, e), "WARN")
        if not dataset.description:
            # Do not change this format for description
            dataset.description = "Dataset for [ AccountId: %s ]" % (accountid)
            try:
                client.update_dataset(dataset, ["description"])
            except:
                pass
    return dataset

def if_tbl_exists(client, table_ref):
    try:
        client.get_table(table_ref)
        return True
    except NotFound:
        return False


def get_cf_v2_uri(cf_name):
    functions_v2_client = functions_v2.FunctionServiceClient()
    request = functions_v2.GetFunctionRequest(
        name=cf_name
    )
    response = functions_v2_client.get_function(request=request)
    return response.service_config.uri


def http_trigger_cf_v2_async(cf_name, trigger_payload):
    # http-trigger a 2nd gen cloudfunction without waiting for http response
    url = get_cf_v2_uri(cf_name)
    try:
        # Set up metadata server request
        # See https://cloud.google.com/compute/docs/instances/verifying-instance-identity#request_signature
        metadata_server_token_url = 'http://metadata/computeMetadata/v1/instance/service-accounts/default/identity?audience='
        token_request_url = metadata_server_token_url + url
        token_request_headers = {'Metadata-Flavor': 'Google'}

        # Fetch the token
        token_response = requests.get(token_request_url, headers=token_request_headers)
        jwt = token_response.content.decode("utf-8")

        # Provide the token in the request to the receiving function
        receiving_function_headers = {'Authorization': f'bearer {jwt}'}
        r = requests.post(url, json=trigger_payload, timeout=1, headers=receiving_function_headers)
    except Exception as e:
        print_(e)
        print_("2nd gen cloudfunction HTTP trigger: Ignore above exception if it's a timeout exception")


def createTable(client, table_ref):
    tableName = table_ref.table_id
    print_("Creating %s table" % tableName)
    schema = []
    clustering_fields = []
    if tableName == CLUSTERDATA or tableName == CLUSTERDATAHOURLY:
        fieldset = bq_schema.clusterDataTableFields
        partition = bigquery.RangePartitioning(
            field="starttime",
            range_=bigquery.PartitionRange(start=1514745000000, end=1893436200000, interval=86400000)
        )
    elif tableName == CLUSTERDATAAGGREGATED or tableName == CLUSTERDATAHOURLYAGGREGATED:
        fieldset = bq_schema.clusterDataAggregatedFields
        partition = bigquery.RangePartitioning(
            field="starttime",
            range_=bigquery.PartitionRange(start=1514745000000, end=1893436200000, interval=86400000)
        )
    elif tableName == PREAGGREGATED:
        fieldset = bq_schema.preAggreagtedTableSchema
        partition = bigquery.TimePartitioning(
            type_=bigquery.TimePartitioningType.DAY,
            field="startTime"
        )
    elif tableName == AWSEC2INVENTORYMETRIC:
        fieldset = bq_schema.awsEc2InventoryCPUSchema
        partition = bigquery.TimePartitioning(
            type_=bigquery.TimePartitioningType.DAY,
            field="addedAt"
        )
    elif tableName.startswith(AWSEC2INVENTORY):
        fieldset = bq_schema.awsEc2InventorySchema
        partition = bigquery.RangePartitioning(
            range_=bigquery.PartitionRange(start=0, end=10000, interval=1),
            field="linkedAccountIdPartition"
        )
    elif tableName == AWSEBSINVENTORYMETRICS:
        fieldset = bq_schema.awsEbsInventoryMetricsSchema
        partition = bigquery.TimePartitioning(
            type_=bigquery.TimePartitioningType.DAY,
            field="addedAt"
        )
    elif tableName.startswith(AWSEBSINVENTORY):
        fieldset = bq_schema.awsEbsInventorySchema
        partition = bigquery.RangePartitioning(
            range_=bigquery.PartitionRange(start=0, end=10000, interval=1),
            field="linkedAccountIdPartition"
        )
    elif tableName.startswith(AWSRDSINVENTORY):
        fieldset = bq_schema.awsRdsInventorySchema
        partition = bigquery.RangePartitioning(
            range_=bigquery.PartitionRange(start=0, end=10000, interval=1),
            field="linkedAccountIdPartition"
        )
    elif tableName.startswith(AWSCURPREFIX):
        fieldset = bq_schema.aws_cur_table_schema
        partition = bigquery.TimePartitioning(
            type_=bigquery.TimePartitioningType.DAY,
            field="usagestartdate"
        )
    elif tableName == UNIFIED:
        fieldset = bq_schema.unifiedTableTableSchema
        partition = bigquery.TimePartitioning(
            type_=bigquery.TimePartitioningType.DAY,
            field="startTime"  # name of column to use for partitioning
        )
    elif tableName == CURRENCYCONVERSIONFACTORUSERINPUT:
        fieldset = bq_schema.currencyConversionFactorUserInputTableTableSchema
        partition = bigquery.TimePartitioning(
            type_=bigquery.TimePartitioningType.DAY,
            field="updatedAt"  # name of column to use for partitioning
        )
    elif tableName == LABELKEYSTOCOLUMNMAPPING:
        fieldset = bq_schema.labelKeysToColumnMappingTableSchema
        clustering_fields = ["labelKey"]
    elif tableName == COSTAGGREGATED:
        fieldset = bq_schema.costAggregatedSchema
        partition = bigquery.TimePartitioning(
            type_=bigquery.TimePartitioningType.DAY,
            field="day"  # name of column to use for partitioning
        )
    elif tableName.startswith(GCPCOSTPREFIX):
        fieldset = bq_schema.gcp_cost_export_table_schema
        partition = bigquery.TimePartitioning(
            type_=bigquery.TimePartitioningType.DAY,
            field="usage_start_time"
        )
    elif tableName.startswith(GCPINSTANCEINVENTORY):
        fieldset = bq_schema.gcpInstanceInventorySchema
        partition = bigquery.TimePartitioning(
            type_=bigquery.TimePartitioningType.DAY,
            field="creationTime"
        )
    elif tableName.startswith(GCPDISKINVENTORY):
        fieldset = bq_schema.gcpDiskInventorySchema
        partition = bigquery.TimePartitioning(
            type_=bigquery.TimePartitioningType.DAY,
            field="creationTime"
        )
    elif tableName.startswith(AZURECOSTPREFIX):
        fieldset = bq_schema.azure_cost_table_schema
        partition = bigquery.TimePartitioning(
            type_=bigquery.TimePartitioningType.DAY,
            field="startTime"
        )
    elif tableName == AZUREVMINVENTORYMETRIC:
        fieldset = bq_schema.azureVMInventoryCPUSchema
        partition = bigquery.TimePartitioning(
            type_=bigquery.TimePartitioningType.DAY,
            field="addedAt"
        )
    elif tableName.startswith(AZUREVMINVENTORY):
        fieldset = bq_schema.azureVMInventorySchema
        partition = bigquery.TimePartitioning(
            type_=bigquery.TimePartitioningType.DAY,
            field="creationTime"
        )

    for field in fieldset:
        if field.get("type") == "RECORD":
            nested_fields = []
            for nested_field in field["fields"]:
                if nested_field.get("type") == "RECORD":
                    inner_nested_fields = [bigquery.SchemaField(inner_nested_field["name"], inner_nested_field["type"],
                                                                mode=inner_nested_field.get("mode", "")) for inner_nested_field in nested_field["fields"]]
                    nested_fields.append(bigquery.SchemaField(nested_field["name"], nested_field["type"],
                                                              mode=nested_field["mode"], fields=inner_nested_fields))
                else:
                    nested_fields.append(bigquery.SchemaField(nested_field["name"], nested_field["type"], mode=nested_field.get("mode", "")))
            schema.append(bigquery.SchemaField(field["name"], field["type"], mode=field["mode"], fields=nested_fields))
        else:
            schema.append(bigquery.SchemaField(field["name"], field["type"], mode=field.get("mode", "")))
    if not schema:
        print_("Could not find any schema for table %s : %s" % (tableName, schema))
        return False
    table = bigquery.Table("%s.%s.%s" % (table_ref.project, table_ref.dataset_id, tableName), schema=schema)

    # Finalize the partitioning method per table
    if tableName in [UNIFIED, CURRENCYCONVERSIONFACTORUSERINPUT, PREAGGREGATED, AWSEC2INVENTORYMETRIC, AWSEBSINVENTORYMETRICS, COSTAGGREGATED, AZUREVMINVENTORYMETRIC] or \
            tableName.startswith(GCPINSTANCEINVENTORY) or tableName.startswith(GCPDISKINVENTORY) or \
            tableName.startswith(AWSCURPREFIX) or tableName.startswith(AZUREVMINVENTORY) or \
            tableName.startswith(AZURECOSTPREFIX) or tableName.startswith(GCPCOSTPREFIX):
        table.time_partitioning = partition
    elif tableName.startswith(AWSEC2INVENTORY) or tableName.startswith(AWSEBSINVENTORY) or \
            tableName in [CLUSTERDATA, CLUSTERDATAAGGREGATED, CLUSTERDATAHOURLY, CLUSTERDATAHOURLYAGGREGATED]:
        table.range_partitioning = partition
    elif clustering_fields:
        table.clustering_fields = clustering_fields

    try:
        if tableName == LABELKEYSTOCOLUMNMAPPING and table.dataset_id.split('BillingReport_')[-1] \
                not in [flattening_enabled_account_id.replace('-','_').lower()
                        for flattening_enabled_account_id in LABELS_FLATTENING_ENABLED_ACCOUNTS]:
            return True
        table = client.create_table(table)  # Make an API request.
        print_("Created table {}.{}.{}".format(table.project, table.dataset_id, table.table_id))
    except Exception as e:
        print_("Error while creating table\n {}".format(e), "WARN")
        return False
    return True


def add_currency_preferences_columns_to_schema(client, table_ids):
    for table_id in table_ids:
        print_(f"Altering {table_id} Table to add currency-preferences columns")
        awscur_columns_query = ", ADD COLUMN IF NOT EXISTS usageamount FLOAT64, " \
                               "ADD COLUMN IF NOT EXISTS amortisedCost FLOAT64, " \
                               "ADD COLUMN IF NOT EXISTS netAmortisedCost FLOAT64" if "awscur" in table_id else ""
        query = f"ALTER TABLE `{table_id}` " \
                f"ADD COLUMN IF NOT EXISTS fxRateSrcToDest FLOAT64, " \
                f"ADD COLUMN IF NOT EXISTS ccmPreferredCurrency STRING" \
                f"{awscur_columns_query};"
        try:
            print_(query)
            query_job = client.query(query)
            query_job.result()
        except Exception as e:
            # Error Running Alter Query
            print_(e)
        else:
            print_(f"Finished Altering {table_id} Table")

def add_msp_markup_column_to_schema(client, table_ids):
    for table_id in table_ids:
        print_(f"Altering {table_id} Table to add msp markup column")
        query = f"ALTER TABLE `{table_id}` " \
                f"ADD COLUMN IF NOT EXISTS mspMarkupMultiplier FLOAT64;"
        try:
            print_(query)
            query_job = client.query(query)
            query_job.result()
        except Exception as e:
            # Error Running Alter Query
            print_(e)
        else:
            print_(f"Finished Altering {table_id} Table")

def run_batch_query(client, query, job_config, timeout=180):
    """
    Util method which runs a BQ query in batch mode.
    :param client:
    :param query:
    :param job_config:
    :param timeout:
    :return:
    """
    if not job_config:
        job_config = bigquery.QueryJobConfig(
            priority=bigquery.QueryPriority.BATCH
        )
    elif isinstance(job_config, bigquery.QueryJobConfig):
        # Explicitly set BATCH priority
        job_config.priority = bigquery.QueryPriority.BATCH

    query_job = client.query(query, job_config=job_config)
    print_(query)
    try:
        print_(query_job.job_id)
        count = 0
        while True:
            query_job = client.get_job(
                query_job.job_id, location=query_job.location
            )
            print_("Job {} is currently in state {}".format(query_job.job_id, query_job.state))
            if query_job.state in ["DONE", "SUCCESS"] or count >= timeout/5:  # 2 minutes
                err = query_job.error_result
                if err:
                    print_(err, "ERROR")
                break
            else:
                time.sleep(5)
                count += 1
        if query_job.state not in ["DONE", "SUCCESS", "RUNNING"]:
            raise Exception(f"Timed-out while waiting for Job [{query_job.job_id}] to begin execution. Job might be incomplete.")
    except Exception as e:
        print_(query, "ERROR")
        print_(e)

def update_connector_data_sync_status(jsonData, PROJECTID, client):
    query = """INSERT INTO `%s.%s.%s` (accountId, connectorId, lastSuccessfullExecutionAt, jobType, cloudProviderId) 
                VALUES ('%s', '%s', '%s', '%s', '%s')
            """ % ( PROJECTID, CEINTERNALDATASET, CONNECTORDATASYNCSTATUSTABLE,
                    jsonData["accountId"], jsonData["connectorId"], datetime.datetime.utcnow(), 'cloudfunction', jsonData['cloudProvider']
                    )

    try:
        print_(query)
        query_job = client.query(query)
        query_job.result()  # wait for job to complete
    except Exception as e:
        print_("  Failed to update connector data sync status", "WARN")
        raise e


def send_event(topic_path, event_data):
    message_json = json.dumps(event_data)
    message_bytes = message_json.encode('utf-8')
    # Publishes a message
    try:
        publish_future = publisher.publish(topic_path, data=message_bytes)
        publish_future.result()  # Verify the publishing succeeded
        print_('Message published: %s.' % event_data)
    except Exception as e:
        print_(e)
        print_("Error while sending event: %s to pubsub: %s" % event_data, topic_path)


def flatten_label_keys_in_table(client, accountId, PROJECTID, dataset_name, table_name, labels_column_name, query_filters):
    if accountId not in LABELS_FLATTENING_ENABLED_ACCOUNTS:
        return
    print_(f"Flattening of labels is enabled for accountId: {accountId}. "
           f"Continuing to flatten the labels in {table_name}.")

    label_key_to_column_mapping = {}
    newly_flattened_label_keys_count = 0

    # Generate (& execute) the following 3 queries in this function:
    # Note: we will use a common mapping-table (LABELKEYSTOCOLUMNMAPPING) for unifiedTable as well as cluster tables.
    add_flattened_columns_query = "ALTER TABLE `%s.%s.%s` " % (PROJECTID, dataset_name, table_name)
    update_flattened_columns_query = "UPDATE `%s.%s.%s` SET " % (PROJECTID, dataset_name, table_name)
    query_to_insert_new_entries_in_mapping_table = "INSERT INTO `%s.%s.%s` (labelKey, columnName) " \
                                                   "SELECT lKey as labelKey, cName as columnName FROM (" \
                                                   % (PROJECTID, dataset_name, LABELKEYSTOCOLUMNMAPPING)

    # get labelKey list from table (unified/cluster) on applying filters [should have csp and time filters applied]
    bq_query = """
        SELECT distinct l.key as labelKey FROM `%s.%s.%s`, UNNEST(%s) as l
        WHERE %s
    """ % (PROJECTID, dataset_name, table_name, labels_column_name, query_filters)
    results = run_bq_query_with_retries(client=client, query=bq_query)
    for row in results:
        label_key_to_column_mapping[row.labelKey] = None

    # set mapped column-names for labelKeys that were already mapped (using the mapping table)
    bq_query = """
        SELECT labelKey, columnName FROM `%s.%s.%s`
    """ % (PROJECTID, dataset_name, LABELKEYSTOCOLUMNMAPPING)
    results = run_bq_query_with_retries(client=client, query=bq_query)
    for row in results:
        if row.labelKey in list(label_key_to_column_mapping.keys()):
            label_key_to_column_mapping[row.labelKey] = row.columnName

    # generate mapping for labelKeys which don't yet have a mapping.
    # ensure to generate a mapping that doesn't exist already in mapping table]
    # also, generate query to persist newly mapped labelKeys into mapping table
    newly_added_label_keys_dict = {}
    for label_key in list(label_key_to_column_mapping.keys()):
        if label_key_to_column_mapping[label_key] is None:
            # i.e. labelKey hasn't been mapped to a column yet. Map it.
            if newly_flattened_label_keys_count > 0:
                query_to_insert_new_entries_in_mapping_table += " union all "

            label_key_to_column_mapping[label_key] = generate_unique_column_name(label_key)
            newly_added_label_keys_dict[label_key] = label_key_to_column_mapping[label_key]

            query_to_insert_new_entries_in_mapping_table += f" select '{label_key}' as lKey, " \
                                                            f"'{label_key_to_column_mapping[label_key]}' as cName "

            newly_flattened_label_keys_count += 1

    # the following "left join" and where-clause will ensure that we dont insert duplicate rows even in cases of
    # concurrent CF executions operating on same labelKey
    query_to_insert_new_entries_in_mapping_table += """)
        LEFT JOIN `%s.%s.%s` t
        ON (lkey=t.labelKey or cName=t.columnName)
        WHERE (t.labelKey IS NULL and t.columnName is null)
    """ % (PROJECTID, dataset_name, LABELKEYSTOCOLUMNMAPPING)

    print_(f"LabelKey-to-Column mapping: {label_key_to_column_mapping}")
    # Trying to insert the new mappings first. Then fetch the latest mapping after that.
    if newly_flattened_label_keys_count > 0:
        try:
            run_bq_query_with_retries(client=client,
                                      query=query_to_insert_new_entries_in_mapping_table,
                                      max_retry_count=3)
        except Exception as e:
            print_(e)
            print_("Error occurred while trying to run query", "ERROR")
            raise e

    # after inserting into mapping table,
    # reloading/overwriting-in-dict using latest mappings from mapping-table which we need for current ingestion
    bq_query_temp = """
        SELECT labelKey, columnName FROM `%s.%s.%s`
    """ % (PROJECTID, dataset_name, LABELKEYSTOCOLUMNMAPPING)
    results = run_bq_query_with_retries(client=client, query=bq_query_temp)
    for row in results:
        if row.labelKey in list(label_key_to_column_mapping.keys()):
            label_key_to_column_mapping[row.labelKey] = row.columnName
    # label_key_to_column_mapping now has the latest labelkey-to-column mappings (even from concurrent runs)

    # generate alter table query for all labelKeys in current ingestion.
    # some labelKeys might already have entry in mapping-table via cluster pipeline,
    # so those mappings won't have a corresponding column in unified (& vice versa)
    # Also, generate update table query, with same query_filters in where clause as used in ingestion.
    # todo: split this update-query in case of too many labelKeys in unified - since it will have many unnest statements
    # break the update-query into multiple queries in that case if required.
    cnt = 0
    for label_key in label_key_to_column_mapping:
        if cnt > 0:
            add_flattened_columns_query += ", "
            update_flattened_columns_query += ", "
        add_flattened_columns_query += f" ADD COLUMN IF NOT EXISTS {label_key_to_column_mapping[label_key]} STRING "
        update_flattened_columns_query += \
            f" {label_key_to_column_mapping[label_key]}=(SELECT value FROM UNNEST({labels_column_name}) WHERE key='{label_key}')"
        cnt += 1
    add_flattened_columns_query += ";"
    update_flattened_columns_query += f" WHERE {query_filters};"

    run_bq_query_with_retries(client=client, query=add_flattened_columns_query, max_retry_count=3)
    run_bq_query_with_retries(client=client, query=update_flattened_columns_query, max_retry_count=3)


def generate_unique_column_name(label_key):
    reg = re.compile("[^a-zA-Z0-9_]")
    unique_deterministic_hash_for_label_key = hashlib.md5(bytes(label_key, 'utf-8')).hexdigest()
    return re.sub(reg, '_', f"LBL_{label_key}_{unique_deterministic_hash_for_label_key}")


def run_bq_query_with_retries(client, query, max_retry_count=1, job_config=None):
    # retries can be used to overcome query failure due to multiple concurrent DMLs
    print_(query)
    for retry_count in range(max_retry_count):
        if retry_count > 0:
            print_("Retrying..")
            # waiting 10 seconds after encountering failure once
            # todo: should we sleep for random number of seconds between 5-15 seconds to ensure all queries
            #  ...are not waking up at same time?
            time.sleep(10)
        try:
            query_job = client.query(query, job_config=job_config) if job_config else client.query(query)
            print_(f"BQ JobId: {query_job.job_id}")
            results = query_job.result()  # wait for job to complete
            return results
        except Exception as e:
            # todo: should we retry only if we catch a specific type of exception related to concurrent DMLs?
            print_(e)
            print_(f"Failed to execute BQ query (retry_count={retry_count+1})!", "ERROR")
            if retry_count + 1 == max_retry_count:
                raise e

